<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Simple Curve Fitting in Python – Introduction to Coding and Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-065a5179aebd64318d7ea99d77b64a9e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d69ecb9bfb3452960edd708ecf92c3b3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="robots" content="noindex, nofollow">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Intro to Coding &amp; Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lessons" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lessons</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lessons">    
        <li>
    <a class="dropdown-item" href="../01/week_01_home.html">
 <span class="dropdown-text">01 - Introduction to Data Types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02/week_02_home.html">
 <span class="dropdown-text">02 - Booleans and Conditionals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03/week_03_home.html">
 <span class="dropdown-text">03 - Loops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../04/week_04_home.html">
 <span class="dropdown-text">04 - Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05/week_05_home.html">
 <span class="dropdown-text">05 - Consolidation: Python on the field</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../07/lecture_intro_numpy.html">
 <span class="dropdown-text">07 - Introduction to NumPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/lecture_working_with_numpy.html">
 <span class="dropdown-text">08 - Working with NumPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/lecture_intro_matplotlib.html">
 <span class="dropdown-text">09 - Introduction to Matplotlib</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/lecture_multidimensionalArrays.html">
 <span class="dropdown-text">10 - Multidimensional Arrays</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/lecture_beyond_the_notebook.html">
 <span class="dropdown-text">11 - Beyond the Notebook</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../13/lecture_pandas.html">
 <span class="dropdown-text">13 - <code>pandas</code> series and data frames</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../14/lecture_pandas_preprocessing.html">
 <span class="dropdown-text">14 - Pre-processing data frames</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../15/lecture_pandas_plotting.html">
 <span class="dropdown-text">15 - Plotting with <code>pandas</code></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../16/lecture_pandas_vs_numpy.html">
 <span class="dropdown-text">16 - Pandas vs Numpy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../17/lecture_advanced_plotting.html">
 <span class="dropdown-text">17 - Advanced Plotting</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercises">    
        <li>
    <a class="dropdown-item" href="../01/exercises_intro.html">
 <span class="dropdown-text">01 - Intro to Data Types Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02/exercises_bool.html">
 <span class="dropdown-text">02 - Booleans and Conditionals Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03/exercises_loop.html">
 <span class="dropdown-text">03 - Loops Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../04/exercises_function.html">
 <span class="dropdown-text">04 - Functions Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05/exercises_python_on_the_field.html">
 <span class="dropdown-text">05 - Python in the Field Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../07/exercises_numpy.html">
 <span class="dropdown-text">07 - NumPy Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/exercises_lecture_working_with_numpy.html">
 <span class="dropdown-text">08 - Working with Numpy Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/exercises_plotting_data_from_file.html">
 <span class="dropdown-text">09 - Plotting Data Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_multid.html">
 <span class="dropdown-text">10 - Working with multidimensional arrays</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_riddles.html">
 <span class="dropdown-text">11 - Riddles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../13/exercises_pandas_basics.html">
 <span class="dropdown-text">13 - Pandas Basics Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../14/exercises_pandas_preprocessing.html">
 <span class="dropdown-text">14 - Pandas Preprocessing Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../15/exercises_pandas_plotting.html">
 <span class="dropdown-text">15 - Pandas Plotting Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../16/exercises_pandas_vs_numpy.html">
 <span class="dropdown-text">16 - Pandas vs Numpy Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../17/exercises_advanced_plotting.html">
 <span class="dropdown-text">17 - Advanced Plotting Exercises</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-solutions" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Solutions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-solutions">    
        <li>
    <a class="dropdown-item" href="../01/week_01_solutions_demonstrator_version.html">
 <span class="dropdown-text">01 - Intro to Data Types Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02/week_02_solutions_demonstrator_version.html">
 <span class="dropdown-text">02 - Booleans and Conditionals Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03/week_03_solutions_demonstrator_version.html">
 <span class="dropdown-text">03 - Loops Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../04/week_04_solutions_demonstrator_version.html">
 <span class="dropdown-text">04 - Functions Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05/week_05_solutions_demonstrator_version.html">
 <span class="dropdown-text">05 - Python in the Field Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../07/exercises_numpy_solutions.html">
 <span class="dropdown-text">07 - NumPy Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/exercises_lecture_working_with_numpy_solutions.html">
 <span class="dropdown-text">08 - NumPy Working Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/exercises_plotting_data_from_file_solutions.html">
 <span class="dropdown-text">09 - Plotting Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part1_solutions.html">
 <span class="dropdown-text">10 - Part 1 Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part2_solutions.html">
 <span class="dropdown-text">10 - Part 2 Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_numpy_riddles_solutions.html">
 <span class="dropdown-text">11 - NumPy Riddles Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_python_riddles_solutions.html">
 <span class="dropdown-text">11 - Python Riddles Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../13/exercises_pandas_basics_solutions.html">
 <span class="dropdown-text">13 - Pandas Basics Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../14/exercises_pandas_preprocessing_solutions.html">
 <span class="dropdown-text">14 - Pandas Preprocessing Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../15/exercises_pandas_plotting_solutions.html">
 <span class="dropdown-text">15 - Pandas Plotting Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../16/exercises_pandas_vs_numpy-solutions.html">
 <span class="dropdown-text">16 - Pandas vs Numpy Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../17/exercises_advanced_plotting-solutions.html">
 <span class="dropdown-text">17 - Advanced Plotting Solutions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-formative-tests" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Formative tests</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-formative-tests">    
        <li>
    <a class="dropdown-item" href="../formative/basic_structures.html">
 <span class="dropdown-text">Variables, lists, dictionaries and branches</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../formative/numpy_basics.html">
 <span class="dropdown-text">Basic numpy structures</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Simple Curve Fitting in Python</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figs/banner.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../figs/banner.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Coding and Data Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">01 Introduction to Data Types</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_beginner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beginner: Basic Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate: Collections</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced: Copying and References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">02 Booleans and Conditionals</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02/week_02_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Booleans and Conditionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02/week_02_booleans_and_conditionals_beginner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beginner: If Statements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02/week_02_booleans_and_conditionals_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate: Match Statements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02/week_02_booleans_and_conditionals_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced: Conditional Expressions and Lazy Evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">03 Loops</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03/week_03_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03/week_03_loops_beginner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beginner: For and While Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03/week_03_loops_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate: Advanced Iteration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03/week_03_loops_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced: Comprehensions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">04 Functions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04/week_04_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04/week_04_functions_beginner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beginner: Defining Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04/week_04_functions_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate: Flexible Inputs and Outputs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04/week_04_functions_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced: Lambda Functions and Functional Programming</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">05 Consolidation: Python in the field</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05/week_05_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05/week_05_chemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chemistry Challenge</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05/week_05_physics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Physics Challenge</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05/week_05_data_science_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Challenge</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">06 Consolidation week</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">07 Introduction to NumPy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07/lecture_intro_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The <code>numpy</code> module</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07/exercises_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>numpy</code> Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">08 Working with NumPy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08/lecture_working_with_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indexing and Random Data Generation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08/exercises_lecture_working_with_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with <code>numpy</code>: Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">09 Introduction to Matplotlib</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/lecture_intro_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting with <code>matplotlib</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/exercises_plotting_data_from_file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting data from file</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/fun_matplotlib_decoration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Add some decoration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">10 Multidimensional Arrays</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/lecture_multidimensionalArrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multi-dimensional arrays</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating a mask containing a circle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using a mask</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">11 Beyond the Notebook</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/lecture_beyond_the_notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beyond the notebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/exercises_riddles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riddles</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">12 Winter break</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">13 <code>pandas</code> series and data frames</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13/lecture_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13/exercises_pandas_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Basics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">14 Pre-processing data frames</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14/lecture_pandas_preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Pre-processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14/exercises_pandas_preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Data Preprocessing - Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">15 Plotting with <code>pandas</code></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15/lecture_pandas_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting with <code>pandas</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15/exercises_pandas_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deforestation Data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">16 Pandas vs Numpy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../16/lecture_pandas_vs_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas vs Numpy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../16/exercises_pandas_vs_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy vs Pandas: Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">17 Advanced Plotting</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../17/lecture_advanced_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Plotting with Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../17/exercises_advanced_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Plotting Exercises: Building Dashboards with Seaborn and Plotly</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-regression-the-simplest-curve-fitting-model" id="toc-linear-regression-the-simplest-curve-fitting-model" class="nav-link active" data-scroll-target="#linear-regression-the-simplest-curve-fitting-model">1. Linear Regression: The Simplest Curve Fitting Model</a>
  <ul class="collapse">
  <li><a href="#the-linear-model" id="toc-the-linear-model" class="nav-link" data-scroll-target="#the-linear-model">The Linear Model</a></li>
  <li><a href="#the-goal-minimize-the-residuals" id="toc-the-goal-minimize-the-residuals" class="nav-link" data-scroll-target="#the-goal-minimize-the-residuals">The Goal: Minimize the Residuals</a></li>
  <li><a href="#the-closed-form-solution-normal-equations" id="toc-the-closed-form-solution-normal-equations" class="nav-link" data-scroll-target="#the-closed-form-solution-normal-equations">The Closed-Form Solution (Normal Equations)</a></li>
  </ul></li>
  <li><a href="#a-simple-example-house-prices-vs.-square-footage" id="toc-a-simple-example-house-prices-vs.-square-footage" class="nav-link" data-scroll-target="#a-simple-example-house-prices-vs.-square-footage">2. A Simple Example: House Prices vs.&nbsp;Square Footage</a>
  <ul class="collapse">
  <li><a href="#implementing-linear-regression-from-scratch" id="toc-implementing-linear-regression-from-scratch" class="nav-link" data-scroll-target="#implementing-linear-regression-from-scratch">2.1 Implementing Linear Regression from Scratch</a></li>
  <li><a href="#matrix-form-of-linear-regression" id="toc-matrix-form-of-linear-regression" class="nav-link" data-scroll-target="#matrix-form-of-linear-regression">2.2 Matrix Form of Linear Regression</a></li>
  </ul></li>
  <li><a href="#practical-implementation-numpys-polyfit" id="toc-practical-implementation-numpys-polyfit" class="nav-link" data-scroll-target="#practical-implementation-numpys-polyfit">3. Practical Implementation: NumPy’s <code>polyfit</code></a></li>
  <li><a href="#extending-the-model-polynomial-quadratic-fitting" id="toc-extending-the-model-polynomial-quadratic-fitting" class="nav-link" data-scroll-target="#extending-the-model-polynomial-quadratic-fitting">4. Extending the Model: Polynomial (Quadratic) Fitting</a>
  <ul class="collapse">
  <li><a href="#from-linear-to-polynomial" id="toc-from-linear-to-polynomial" class="nav-link" data-scroll-target="#from-linear-to-polynomial">From Linear to Polynomial</a></li>
  <li><a href="#why-does-this-work-mathematically" id="toc-why-does-this-work-mathematically" class="nav-link" data-scroll-target="#why-does-this-work-mathematically">Why Does This Work Mathematically?</a></li>
  <li><a href="#example-curved-relationship" id="toc-example-curved-relationship" class="nav-link" data-scroll-target="#example-curved-relationship">4.1 Example: Curved Relationship</a></li>
  <li><a href="#quadratic-fitting-from-scratch-matrix-method" id="toc-quadratic-fitting-from-scratch-matrix-method" class="nav-link" data-scroll-target="#quadratic-fitting-from-scratch-matrix-method">4.2 Quadratic Fitting from Scratch (Matrix Method)</a></li>
  </ul></li>
  <li><a href="#practical-example-real-data-with-multiple-models" id="toc-practical-example-real-data-with-multiple-models" class="nav-link" data-scroll-target="#practical-example-real-data-with-multiple-models">6. Practical Example: Real Data with Multiple Models</a></li>
  <li><a href="#quick-reference-common-workflows" id="toc-quick-reference-common-workflows" class="nav-link" data-scroll-target="#quick-reference-common-workflows">8. Quick Reference: Common Workflows</a>
  <ul class="collapse">
  <li><a href="#workflow-1-quick-polynomial-fit" id="toc-workflow-1-quick-polynomial-fit" class="nav-link" data-scroll-target="#workflow-1-quick-polynomial-fit">Workflow 1: Quick Polynomial Fit</a></li>
  <li><a href="#workflow-2-evaluate-multiple-models" id="toc-workflow-2-evaluate-multiple-models" class="nav-link" data-scroll-target="#workflow-2-evaluate-multiple-models">Workflow 2: Evaluate Multiple Models</a></li>
  <li><a href="#workflow-3-manual-implementation-from-scratch" id="toc-workflow-3-manual-implementation-from-scratch" class="nav-link" data-scroll-target="#workflow-3-manual-implementation-from-scratch">Workflow 3: Manual Implementation (From Scratch)</a></li>
  </ul></li>
  <li><a href="#practice-problems" id="toc-practice-problems" class="nav-link" data-scroll-target="#practice-problems">9. Practice Problems</a>
  <ul class="collapse">
  <li><a href="#problem-1-temperature-vs.-ice-cream-sales" id="toc-problem-1-temperature-vs.-ice-cream-sales" class="nav-link" data-scroll-target="#problem-1-temperature-vs.-ice-cream-sales">Problem 1: Temperature vs.&nbsp;Ice Cream Sales</a></li>
  <li><a href="#problem-2-implement-cubic-fitting-from-scratch" id="toc-problem-2-implement-cubic-fitting-from-scratch" class="nav-link" data-scroll-target="#problem-2-implement-cubic-fitting-from-scratch">Problem 2: Implement Cubic Fitting from Scratch</a></li>
  <li><a href="#problem-3-predictions" id="toc-problem-3-predictions" class="nav-link" data-scroll-target="#problem-3-predictions">Problem 3: Predictions</a></li>
  <li><a href="#problem-4-overfitting-investigation" id="toc-problem-4-overfitting-investigation" class="nav-link" data-scroll-target="#problem-4-overfitting-investigation">Problem 4: Overfitting Investigation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Simple Curve Fitting in Python</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In previous lectures, we learned how to visualize data using <code>matplotlib</code> and <code>pandas</code>, and how to perform numerical computations with <code>numpy</code>. A natural next step is to ask: <strong>can we find a mathematical model that describes the relationship between variables in our data?</strong></p>
<p>Curve fitting is the process of constructing a mathematical function that passes through (or near) a set of data points. This is one of the fundamental techniques in data analysis and has applications across science, engineering, and business:</p>
<ul>
<li><strong>Physics</strong>: Fitting experimental data to theoretical models</li>
<li><strong>Economics</strong>: Fitting economic indicators to predict trends</li>
<li><strong>Biology</strong>: Modeling growth curves and drug concentration over time</li>
<li><strong>Finance</strong>: Fitting price histories to predict future movements</li>
</ul>
<p>In this lecture, we will learn: 1. The mathematical foundations of linear regression from scratch 2. How to implement linear fitting explicitly using numpy operations 3. How polynomial fittingextends the linear model 4. How to use numpy’s <code>polyfit</code> function for practical applications</p>
<p>We will build understanding progressively, starting with the simplest case and building up to more complex models.</p>
<div>
<div id="pyodide-1" class="exercise-cell">

</div>
<script type="pyodide-1-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiJpbXBvcnQgbnVtcHkgYXMgbnBcbmltcG9ydCBwYW5kYXMgYXMgcGRcbmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHRcblxuIyBTZXQgcmFuZG9tIHNlZWQgZm9yIHJlcHJvZHVjaWJpbGl0eVxucm5nID0gbnAucmFuZG9tLmRlZmF1bHRfcm5nKDQyKSJ9
</script>
</div>
<section id="linear-regression-the-simplest-curve-fitting-model" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-the-simplest-curve-fitting-model">1. Linear Regression: The Simplest Curve Fitting Model</h2>
<p>Let’s start with the simplest case: fitting a <strong>linear model</strong> to data. The goal is to find a line that best describes the relationship between two variables.</p>
<section id="the-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="the-linear-model">The Linear Model</h3>
<p>The linear model assumes that <span class="math inline">\(y\)</span> (the dependent variable) is related to <span class="math inline">\(x\)</span> (the independent variable) by:</p>
<p><span class="math display">\[y = mx + b\]</span></p>
<p>where: - <span class="math inline">\(m\)</span> is the <strong>slope</strong> (how much <span class="math inline">\(y\)</span> changes when <span class="math inline">\(x\)</span> increases by 1) - <span class="math inline">\(b\)</span> is the <strong>intercept</strong> (the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>)</p>
<p>In practice, real data rarely falls exactly on a line. There is always some <strong>noise</strong> or <strong>error</strong>. So the model is:</p>
<p><span class="math display">\[y_i = mx_i + b + \epsilon_i\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\)</span> represents the error in observation <span class="math inline">\(i\)</span>.</p>
</section>
<section id="the-goal-minimize-the-residuals" class="level3">
<h3 class="anchored" data-anchor-id="the-goal-minimize-the-residuals">The Goal: Minimize the Residuals</h3>
<p>When we <strong>fit</strong> a line to data, we want to find the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> that make the <strong>residuals</strong> (the differences between observed and predicted values) as small as possible.</p>
<p>For each data point <span class="math inline">\(i\)</span>: - <strong>Observed value</strong>: <span class="math inline">\(y_i\)</span> - <strong>Predicted value</strong>: <span class="math inline">\(\hat{y}_i = mx_i + b\)</span> - <strong>Residual</strong>: <span class="math inline">\(r_i = y_i - \hat{y}_i\)</span></p>
<p>A common approach is <strong>least squares fitting</strong>, which minimizes the sum of squared residuals:</p>
<p><span class="math display">\[\text{Loss} = \sum_{i=1}^{n} (y_i - (mx_i + b))^2\]</span></p>
<p>This loss function is convex, which means it has a single minimum—the unique best solution.</p>
</section>
<section id="the-closed-form-solution-normal-equations" class="level3">
<h3 class="anchored" data-anchor-id="the-closed-form-solution-normal-equations">The Closed-Form Solution (Normal Equations)</h3>
<p>Calculus tells us that the minimum of the loss function occurs when its derivatives with respect to <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> are zero. Solving these equations gives us the <strong>normal equations</strong>, which directly compute the optimal <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[m = \frac{n\sum x_i y_i - \sum x_i \sum y_i}{n\sum x_i^2 - (\sum x_i)^2}\]</span></p>
<p><span class="math display">\[b = \frac{\sum y_i - m\sum x_i}{n}\]</span></p>
<p>In alternative form (using means):</p>
<p><span class="math display">\[m = \frac{\text{Cov}(x, y)}{\text{Var}(x)}, \quad b = \bar{y} - m\bar{x}\]</span></p>
<p>These formulas give us the optimal slope and intercept without iterative optimization!</p>
</section>
</section>
<section id="a-simple-example-house-prices-vs.-square-footage" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-example-house-prices-vs.-square-footage">2. A Simple Example: House Prices vs.&nbsp;Square Footage</h2>
<p>Let’s create a simple dataset and fit it by hand to understand the process concretely.</p>
<div>
<div id="pyodide-2" class="exercise-cell">

</div>
<script type="pyodide-2-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEdlbmVyYXRlIHN5bnRoZXRpYyBob3VzZSBwcmljZSBkYXRhXG4jIFRydWUgcmVsYXRpb25zaGlwOiBwcmljZSA9IDIwMCAqIHNxZnQgKyA1MDAwMCAocGx1cyBzb21lIG5vaXNlKVxuXG5uX2hvdXNlcyA9IDIwXG5cbnNxZnQgPSBucC5hcnJheShbMTIwMCwgMTUwMCwgMTgwMCwgOTAwLCAyMTAwLCAxMDUwLCAxNjAwLCAyMjAwLCAxNDAwLCAyNTAwLFxuICAgICAgICAgICAgICAgICAxMTAwLCAxNzAwLCAyMDAwLCAxMzAwLCAxOTAwLCAxNDAwLCAyMzAwLCAxMTAwLCAyMTAwLCAxNjAwXSlcblxuIyBQcmljZSBoYXMgYSBsaW5lYXIgcmVsYXRpb25zaGlwIHdpdGggc3FmdCwgcGx1cyBzb21lIHJhbmRvbSBub2lzZVxucHJpY2UgPSAyMDAgKiBzcWZ0ICsgNTAwMDAgKyBybmcubm9ybWFsKDAsIDMwMDAwLCBuX2hvdXNlcylcblxuIyBDcmVhdGUgYSBEYXRhRnJhbWUgZm9yIGNsYXJpdHlcbmRmX2hvdXNlcyA9IHBkLkRhdGFGcmFtZSh7J3NxZnQnOiBzcWZ0LCAncHJpY2UnOiBwcmljZX0pXG5wcmludChkZl9ob3VzZXMpIn0=
</script>
</div>
<div>
<div id="pyodide-3" class="exercise-cell">

</div>
<script type="pyodide-3-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEZpcnN0LCBsZXQncyB2aXN1YWxpemUgdGhlIHJhdyBkYXRhXG5wbHQuc2NhdHRlcihkZl9ob3VzZXNbJ3NxZnQnXSwgZGZfaG91c2VzWydwcmljZSddLCBzPTEwMCwgYWxwaGE9MC42LCBjb2xvcj0nc3RlZWxibHVlJylcbnBsdC54bGFiZWwoJ1NxdWFyZSBGb290YWdlJylcbnBsdC55bGFiZWwoJ1ByaWNlIChHQlApJylcbnBsdC50aXRsZSgnSG91c2UgUHJpY2VzIHZzLiBTcXVhcmUgRm9vdGFnZSAoUmF3IERhdGEpJylcbnBsdC50aWdodF9sYXlvdXQoKVxucGx0LnNob3coKVxuXG5wcmludChmXCJOdW1iZXIgb2YgaG91c2VzOiB7bGVuKGRmX2hvdXNlcyl9XCIpXG5wcmludChmXCJNZWFuIHByaWNlOiAke2RmX2hvdXNlc1sncHJpY2UnXS5tZWFuKCk6LC4wZn1cIilcbnByaW50KGZcIk1lYW4gc3FmdDoge2RmX2hvdXNlc1snc3FmdCddLm1lYW4oKTosLjBmfVwiKSJ9
</script>
</div>
<section id="implementing-linear-regression-from-scratch" class="level3">
<h3 class="anchored" data-anchor-id="implementing-linear-regression-from-scratch">2.1 Implementing Linear Regression from Scratch</h3>
<p>Now, let’s implement linear regression using only numpy operations. We’ll use the normal equations to compute the optimal slope and intercept directly.</p>
<p><strong>Method 1: Using the algebraic formula</strong></p>
<div>
<div id="pyodide-4" class="exercise-cell">

</div>
<script type="pyodide-4-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiJ4ID0gZGZfaG91c2VzWydzcWZ0J10udmFsdWVzXG55ID0gZGZfaG91c2VzWydwcmljZSddLnZhbHVlc1xubiA9IGxlbih4KVxuXG4jIFVzaW5nIHRoZSBub3JtYWwgZXF1YXRpb25zOlxuIyBtID0gKG4gKiBzdW0oeHkpIC0gc3VtKHgpICogc3VtKHkpKSAvIChuICogc3VtKHheMikgLSAoc3VtKHgpKV4yKVxuIyBiID0gKHN1bSh5KSAtIG0gKiBzdW0oeCkpIC8gblxuXG5udW1lcmF0b3JfbSA9IG4gKiBucC5zdW0oeCAqIHkpIC0gbnAuc3VtKHgpICogbnAuc3VtKHkpXG5kZW5vbWluYXRvcl9tID0gbiAqIG5wLnN1bSh4KioyKSAtIChucC5zdW0oeCkpKioyXG5cbm0gPSBudW1lcmF0b3JfbSAvIGRlbm9taW5hdG9yX21cbmIgPSAobnAuc3VtKHkpIC0gbSAqIG5wLnN1bSh4KSkgLyBuXG5cbnByaW50KGZcIkZpdHRlZCBlcXVhdGlvbjogcHJpY2UgPSB7bTouMmZ9ICogc3FmdCArIHtiOiwuMmZ9XCIpXG5wcmludChmXCJcXG5JbnRlcnByZXRhdGlvbjpcIilcbnByaW50KGZcIiAgLSBTbG9wZSAobSkgPSB7bTouMmZ9OiBFYWNoIGFkZGl0aW9uYWwgc3FmdCBhZGRzICR7bTouMmZ9IHRvIHRoZSBwcmljZVwiKVxucHJpbnQoZlwiICAtIEludGVyY2VwdCAoYikgPSAke2I6LC4yZn06IEJhc2VsaW5lIHByaWNlICh3aGVuIHNxZnQgPSAwKVwiKSJ9
</script>
</div>
<div>
<div id="pyodide-5" class="exercise-cell">

</div>
<script type="pyodide-5-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIE1ha2UgcHJlZGljdGlvbnMgZm9yIGFsbCB4IHZhbHVlc1xueV9wcmVkID0gbSAqIHggKyBiXG5cbiMgQ29tcHV0ZSByZXNpZHVhbHNcbnJlc2lkdWFscyA9IHkgLSB5X3ByZWRcblxuIyBDb21wdXRlIHN1bSBvZiBzcXVhcmVkIHJlc2lkdWFscyBhbmQgUi1zcXVhcmVkXG5zc19yZXMgPSBucC5zdW0ocmVzaWR1YWxzKioyKVxuc3NfdG90ID0gbnAuc3VtKCh5IC0gbnAubWVhbih5KSkqKjIpXG5yX3NxdWFyZWQgPSAxIC0gKHNzX3JlcyAvIHNzX3RvdClcblxucHJpbnQoZlwiU3VtIG9mIFNxdWFyZWQgUmVzaWR1YWxzOiB7c3NfcmVzOiwuMmZ9XCIpXG5wcmludChmXCJSLXNxdWFyZWQgKENvZWZmaWNpZW50IG9mIERldGVybWluYXRpb24pOiB7cl9zcXVhcmVkOi40Zn1cIilcbnByaW50KGZcIlxcbkludGVycHJldGF0aW9uIG9mIFLCsjpcIilcbnByaW50KGZcIiAgLSBPdXIgbW9kZWwgZXhwbGFpbnMge3Jfc3F1YXJlZCoxMDA6LjJmfSUgb2YgdGhlIHZhcmlhbmNlIGluIHByaWNlc1wiKVxucHJpbnQoZlwiICAtIFZhbHVlcyBjbG9zZXIgdG8gMS4wIGluZGljYXRlIGJldHRlciBmaXRcIikifQ==
</script>
</div>
<div>
<div id="pyodide-6" class="exercise-cell">

</div>
<script type="pyodide-6-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIFBsb3QgcmF3IGRhdGFcbnBsdC5zY2F0dGVyKHgsIHksIHM9MTAwLCBhbHBoYT0wLjYsIGNvbG9yPSdzdGVlbGJsdWUnLCBsYWJlbD0nQWN0dWFsIGRhdGEnLCB6b3JkZXI9MylcblxuIyBQbG90IGZpdHRlZCBsaW5lXG54X2xpbmUgPSBucC5hcnJheShbeC5taW4oKSwgeC5tYXgoKV0pXG55X2xpbmUgPSBtICogeF9saW5lICsgYlxucGx0LnBsb3QoeF9saW5lLCB5X2xpbmUsICdyLScsIGxpbmV3aWR0aD0yLjUsIGxhYmVsPWYnRml0dGVkIGxpbmU6IHkgPSB7bTouMmZ9eCArIHtiOiwuMGZ9Jywgem9yZGVyPTIpXG5cbiMgRHJhdyByZXNpZHVhbHMgYXMgdmVydGljYWwgbGluZXNcbmZvciB4aSwgeWksIHlwaSBpbiB6aXAoeCwgeSwgeV9wcmVkKTpcbiAgICBwbHQucGxvdChbeGksIHhpXSwgW3lpLCB5cGldLCAnZy0tJywgYWxwaGE9MC4zLCBsaW5ld2lkdGg9MSlcblxucGx0LnNjYXR0ZXIoeCwgeV9wcmVkLCBzPTUwLCBhbHBoYT0wLjUsIGNvbG9yPSdyZWQnLCBtYXJrZXI9J3gnLCBsaW5ld2lkdGhzPTIsIGxhYmVsPSdQcmVkaWN0ZWQgdmFsdWVzJywgem9yZGVyPTMpXG5cbnBsdC54bGFiZWwoJ1NxdWFyZSBGb290YWdlJylcbnBsdC55bGFiZWwoJ1ByaWNlIChHQlApJylcbnBsdC50aXRsZShmJ0xpbmVhciBSZWdyZXNzaW9uIEZpdCAoUsKyID0ge3Jfc3F1YXJlZDouNGZ9KScpXG5wbHQubGVnZW5kKClcbnBsdC50aWdodF9sYXlvdXQoKVxucGx0LnNob3coKSJ9
</script>
</div>
</section>
<section id="matrix-form-of-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="matrix-form-of-linear-regression">2.2 Matrix Form of Linear Regression</h3>
<p>The normal equations can be written in <strong>matrix form</strong>, which is more general and extensible (we’ll use this to fit polynomials later):</p>
<p>We want to solve:</p>
<p><span class="math display">\[\mathbf{X} \mathbf{\beta} = \mathbf{y}\]</span></p>
<p>where: - <span class="math inline">\(\mathbf{X}\)</span> is the <strong>design matrix</strong> (augmented with a column of 1’s for the intercept) - <span class="math inline">\(\mathbf{\beta}\)</span> contains the parameters we want to estimate <span class="math inline">\([b, m]^T\)</span> - <span class="math inline">\(\mathbf{y}\)</span> is the vector of observations</p>
<p>The least-squares solution is:</p>
<p><span class="math display">\[\mathbf{\beta} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{y}\]</span></p>
<p>This is a more general formulation that works for any number of features!</p>
<div>
<div id="pyodide-7" class="exercise-cell">

</div>
<script type="pyodide-7-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIENvbnN0cnVjdCB0aGUgZGVzaWduIG1hdHJpeCBYIChjb2x1bW4gb2YgMSdzIGZvciBpbnRlcmNlcHQsIHRoZW4geCB2YWx1ZXMpXG4jIFggaXMgc2hhcGUgKG4sIDIpXG5YID0gbnAuY29sdW1uX3N0YWNrKFtucC5vbmVzKG4pLCB4XSlcblxucHJpbnQoXCJEZXNpZ24gbWF0cml4IFggKGZpcnN0IDUgcm93cyk6XCIpXG5wcmludChYWzo1XSlcbnByaW50KGZcIlxcblNoYXBlIG9mIFg6IHtYLnNoYXBlfVwiKVxucHJpbnQoZlwiU2hhcGUgb2YgeToge3kuc2hhcGV9XCIpXG5cbiMgU29sdmUgdXNpbmcgdGhlIG5vcm1hbCBlcXVhdGlvbnM6IGJldGEgPSAoWF5UIFgpXi0xIFheVCB5XG5YdFggPSBYLlQgQCBYICAjIFggdHJhbnNwb3NlIHRpbWVzIFhcblh0eSA9IFguVCBAIHkgICMgWCB0cmFuc3Bvc2UgdGltZXMgeVxuXG4jIFNvbHZlIGZvciBiZXRhXG5iZXRhID0gbnAubGluYWxnLnNvbHZlKFh0WCwgWHR5KVxuXG5iX21hdHJpeCA9IGJldGFbMF0gICMgaW50ZXJjZXB0XG5tX21hdHJpeCA9IGJldGFbMV0gICMgc2xvcGVcblxucHJpbnQoZlwiXFxuVXNpbmcgbWF0cml4IGZvcm06XCIpXG5wcmludChmXCJJbnRlcmNlcHQgKGIpOiB7Yl9tYXRyaXg6LC4yZn1cIilcbnByaW50KGZcIlNsb3BlIChtKToge21fbWF0cml4Oi4yZn1cIilcbnByaW50KGZcIlxcblZlcmlmaWNhdGlvbjogRG9lcyBtYXRyaXggZm9ybSBtYXRjaCBhbGdlYnJhaWMgZm9ybXVsYT9cIilcbnByaW50KGZcIiAgLSBtOiB7YWJzKG0gLSBtX21hdHJpeCkgPCAxZS0xMH1cIilcbnByaW50KGZcIiAgLSBiOiB7YWJzKGIgLSBiX21hdHJpeCkgPCAxZS0xMH1cIikifQ==
</script>
</div>
</section>
</section>
<section id="practical-implementation-numpys-polyfit" class="level2">
<h2 class="anchored" data-anchor-id="practical-implementation-numpys-polyfit">3. Practical Implementation: NumPy’s <code>polyfit</code></h2>
<p>Rather than implementing the matrix math ourselves every time, numpy provides the <code>polyfit</code> function, which fits a polynomial of specified degree to data. For linear regression, we use degree 1.</p>
<p><strong>Syntax</strong>: <code>np.polyfit(x, y, degree)</code> returns the coefficients of the polynomial.</p>
<div>
<div id="pyodide-8" class="exercise-cell">

</div>
<script type="pyodide-8-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIExpbmVhciBmaXQgdXNpbmcgcG9seWZpdCAoZGVncmVlIDEpXG5jb2VmZnNfbGluZWFyID0gbnAucG9seWZpdCh4LCB5LCBkZWc9MSlcblxucHJpbnQoXCJVc2luZyBucC5wb2x5Zml0KHgsIHksIGRlZ3JlZT0xKTpcIilcbnByaW50KGZcIkNvZWZmaWNpZW50czoge2NvZWZmc19saW5lYXJ9XCIpXG5wcmludChmXCIgIC0gU2xvcGUgKGNvZWZmaWNpZW50IG9mIHgpOiB7Y29lZmZzX2xpbmVhclswXTouMmZ9XCIpXG5wcmludChmXCIgIC0gSW50ZXJjZXB0IChjb25zdGFudCB0ZXJtKToge2NvZWZmc19saW5lYXJbMV06LC4yZn1cIilcblxuIyBDcmVhdGUgYSBwb2x5bm9taWFsIGZ1bmN0aW9uIGZyb20gdGhlIGNvZWZmaWNpZW50c1xucG9seV9saW5lYXIgPSBucC5wb2x5MWQoY29lZmZzX2xpbmVhcilcblxucHJpbnQoZlwiXFxuUG9seW5vbWlhbCBmdW5jdGlvbjoge3BvbHlfbGluZWFyfVwiKVxucHJpbnQoZlwiXFxuRXhhbXBsZTogRm9yIGEgMTUwMCBzcWZ0IGhvdXNlLCBwcmVkaWN0ZWQgcHJpY2UgPSAke3BvbHlfbGluZWFyKDE1MDApOiwuMmZ9XCIpXG5cbiMgVmVyaWZ5IHRoaXMgbWF0Y2hlcyBvdXIgaGFuZC1jb21wdXRlZCB2YWx1ZXNcbnByaW50KGZcIlxcblZlcmlmaWNhdGlvbjpcIilcbnByaW50KGZcIiAgcG9seWZpdCBzbG9wZSB2cyBoYW5kLWNvbXB1dGVkOiB7YWJzKGNvZWZmc19saW5lYXJbMF0gLSBtKSA8IDFlLTEwfVwiKVxucHJpbnQoZlwiICBwb2x5Zml0IGludGVyY2VwdCB2cyBoYW5kLWNvbXB1dGVkOiB7YWJzKGNvZWZmc19saW5lYXJbMV0gLSBiKSA8IDFlLTEwfVwiKSJ9
</script>
</div>
</section>
<section id="extending-the-model-polynomial-quadratic-fitting" class="level2">
<h2 class="anchored" data-anchor-id="extending-the-model-polynomial-quadratic-fitting">4. Extending the Model: Polynomial (Quadratic) Fitting</h2>
<p>The linear model works well when the relationship is… well, linear. But many real-world relationships are curved. How can we extend our approach?</p>
<section id="from-linear-to-polynomial" class="level3">
<h3 class="anchored" data-anchor-id="from-linear-to-polynomial">From Linear to Polynomial</h3>
<p>The beauty of the least-squares approach is that it’s <strong>not limited to linear relationships</strong>. We can fit polynomials of any degree:</p>
<ul>
<li><strong>Degree 1 (Linear)</strong>: <span class="math inline">\(y = b + mx\)</span></li>
<li><strong>Degree 2 (Quadratic)</strong>: <span class="math inline">\(y = b + mx + cx^2\)</span></li>
<li><strong>Degree 3 (Cubic)</strong>: <span class="math inline">\(y = b + mx + cx^2 + dx^3\)</span></li>
<li><strong>General degree n</strong>: <span class="math inline">\(y = b + m_1 x + m_2 x^2 + \cdots + m_n x^n\)</span></li>
</ul>
</section>
<section id="why-does-this-work-mathematically" class="level3">
<h3 class="anchored" data-anchor-id="why-does-this-work-mathematically">Why Does This Work Mathematically?</h3>
<p>The key insight is that <strong>even though</strong> we’re fitting to powers of <span class="math inline">\(x\)</span>, <strong>the problem is still linear in the parameters</strong>.</p>
<p>For the quadratic case, we can rewrite:</p>
<p><span class="math display">\[y = b + mx + cx^2\]</span></p>
<p>If we define <span class="math inline">\(x_1 = x\)</span> and <span class="math inline">\(x_2 = x^2\)</span>, then:</p>
<p><span class="math display">\[y = b + m x_1 + c x_2\]</span></p>
<p>This is now linear in <span class="math inline">\((b, m, c)\)</span> and can be solved using the same matrix approach! We just construct the design matrix differently:</p>
<p><span class="math display">\[\mathbf{X} = \begin{bmatrix} 1 &amp; x_1 &amp; x_1^2 \\ 1 &amp; x_2 &amp; x_2^2 \\ \vdots &amp; \vdots &amp; \vdots \end{bmatrix}\]</span></p>
<p>And everything else follows.</p>
</section>
<section id="example-curved-relationship" class="level3">
<h3 class="anchored" data-anchor-id="example-curved-relationship">4.1 Example: Curved Relationship</h3>
<p>Let’s create a dataset with a curved (quadratic) relationship and compare linear vs.&nbsp;quadratic fits.</p>
<div>
<div id="pyodide-9" class="exercise-cell">

</div>
<script type="pyodide-9-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEdlbmVyYXRlIGN1cnZlZCBkYXRhOiB5ID0gMSArIDIqeCArIDAuMDEqeF4yICsgbm9pc2VcbiMgVGhpcyByZXByZXNlbnRzIGEgcmVsYXRpb25zaGlwIHRoYXQgYWNjZWxlcmF0ZXMgKGUuZy4sIGRpc3RhbmNlIHZzIHRpbWUgd2l0aCBhY2NlbGVyYXRpb24pXG5cbm5fcG9pbnRzID0gMzBcbnhfY3VydmVkID0gbnAubGluc3BhY2UoMCwgMTAwLCBuX3BvaW50cylcblxuIyBUcnVlIHF1YWRyYXRpYyByZWxhdGlvbnNoaXAgd2l0aCBub2lzZVxueV9jdXJ2ZWQgPSAxICsgMip4X2N1cnZlZCArIDAuMDEqKHhfY3VydmVkKioyKSArIHJuZy5ub3JtYWwoMCwgMjAsIG5fcG9pbnRzKVxuXG5kZl9jdXJ2ZWQgPSBwZC5EYXRhRnJhbWUoeyd4JzogeF9jdXJ2ZWQsICd5JzogeV9jdXJ2ZWR9KVxuXG4jIEZpdCBsaW5lYXIgbW9kZWwgKGRlZ3JlZSAxKVxuY29lZmZzX2RlZzEgPSBucC5wb2x5Zml0KHhfY3VydmVkLCB5X2N1cnZlZCwgZGVnPTEpXG5wb2x5X2RlZzEgPSBucC5wb2x5MWQoY29lZmZzX2RlZzEpXG5cbiMgRml0IHF1YWRyYXRpYyBtb2RlbCAoZGVncmVlIDIpXG5jb2VmZnNfZGVnMiA9IG5wLnBvbHlmaXQoeF9jdXJ2ZWQsIHlfY3VydmVkLCBkZWc9MilcbnBvbHlfZGVnMiA9IG5wLnBvbHkxZChjb2VmZnNfZGVnMilcblxucHJpbnQoXCJGaXR0ZWQgTW9kZWxzOlwiKVxucHJpbnQoZlwiXFxuTGluZWFyIChkZWdyZWUgMSk6XCIpXG5wcmludChmXCIgIEVxdWF0aW9uOiB7cG9seV9kZWcxfVwiKVxucHJpbnQoZlwiICBDb2VmZmljaWVudHM6IGI9e2NvZWZmc19kZWcxWzFdOi40Zn0sIG09e2NvZWZmc19kZWcxWzBdOi40Zn1cIilcblxucHJpbnQoZlwiXFxuUXVhZHJhdGljIChkZWdyZWUgMik6XCIpXG5wcmludChmXCIgIEVxdWF0aW9uOiB7cG9seV9kZWcyfVwiKVxucHJpbnQoZlwiICBDb2VmZmljaWVudHM6IGI9e2NvZWZmc19kZWcyWzJdOi40Zn0sIG09e2NvZWZmc19kZWcyWzFdOi40Zn0sIGM9e2NvZWZmc19kZWcyWzBdOi40Zn1cIilcblxuIyBDb21wdXRlIFLCsiBmb3IgYm90aFxueV9wcmVkX2RlZzEgPSBwb2x5X2RlZzEoeF9jdXJ2ZWQpXG55X3ByZWRfZGVnMiA9IHBvbHlfZGVnMih4X2N1cnZlZClcblxuc3NfdG90ID0gbnAuc3VtKCh5X2N1cnZlZCAtIG5wLm1lYW4oeV9jdXJ2ZWQpKSoqMilcbnIyX2RlZzEgPSAxIC0gbnAuc3VtKCh5X2N1cnZlZCAtIHlfcHJlZF9kZWcxKSoqMikgLyBzc190b3RcbnIyX2RlZzIgPSAxIC0gbnAuc3VtKCh5X2N1cnZlZCAtIHlfcHJlZF9kZWcyKSoqMikgLyBzc190b3RcblxucHJpbnQoZlwiXFxuXFxuTW9kZWwgQ29tcGFyaXNvbjpcIilcbnByaW50KGZcIiAgTGluZWFyIFLCsjoge3IyX2RlZzE6LjZmfVwiKVxucHJpbnQoZlwiICBRdWFkcmF0aWMgUsKyOiB7cjJfZGVnMjouNmZ9XCIpXG5wcmludChmXCIgIEltcHJvdmVtZW50OiB7KHIyX2RlZzIgLSByMl9kZWcxKSoxMDA6LjJmfSBwZXJjZW50YWdlIHBvaW50c1wiKSJ9
</script>
</div>
<div>
<div id="pyodide-10" class="exercise-cell">

</div>
<script type="pyodide-10-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIFZpc3VhbGl6ZSBib3RoIGZpdHNcbmZpZywgYXhlcyA9IHBsdC5zdWJwbG90cygxLCAyKVxuXG4jIExlZnQgcGxvdDogTGluZWFyIGZpdFxuYXggPSBheGVzWzBdXG54X3Ntb290aCA9IG5wLmxpbnNwYWNlKHhfY3VydmVkLm1pbigpLCB4X2N1cnZlZC5tYXgoKSwgMTAwKVxuYXguc2NhdHRlcih4X2N1cnZlZCwgeV9jdXJ2ZWQsIHM9ODAsIGFscGhhPTAuNiwgY29sb3I9J3N0ZWVsYmx1ZScsIGxhYmVsPSdEYXRhJylcbmF4LnBsb3QoeF9zbW9vdGgsIHBvbHlfZGVnMSh4X3Ntb290aCksICdyLScsIGxpbmV3aWR0aD0yLjUsIGxhYmVsPWYnTGluZWFyIGZpdCAoUsKyPXtyMl9kZWcxOi40Zn0pJylcbmF4LnNldF94bGFiZWwoJ3gnKVxuYXguc2V0X3lsYWJlbCgneScpXG5heC5zZXRfdGl0bGUoJ0xpbmVhciBNb2RlbCAoRGVncmVlIDEpJylcbmF4LmxlZ2VuZChmcmFtZW9uPUZhbHNlKVxuXG4jIFJpZ2h0IHBsb3Q6IFF1YWRyYXRpYyBmaXRcbmF4ID0gYXhlc1sxXVxuYXguc2NhdHRlcih4X2N1cnZlZCwgeV9jdXJ2ZWQsIHM9ODAsIGFscGhhPTAuNiwgY29sb3I9J3N0ZWVsYmx1ZScsIGxhYmVsPSdEYXRhJylcbmF4LnBsb3QoeF9zbW9vdGgsIHBvbHlfZGVnMih4X3Ntb290aCksICdnLScsIGxpbmV3aWR0aD0yLjUsIGxhYmVsPWYnUXVhZHJhdGljIGZpdCAoUsKyPXtyMl9kZWcyOi40Zn0pJylcbmF4LnNldF94bGFiZWwoJ3gnLClcbmF4LnNldF95bGFiZWwoJ3knLClcbmF4LnNldF90aXRsZSgnUXVhZHJhdGljIE1vZGVsIChEZWdyZWUgMiknKVxuYXgubGVnZW5kKGZyYW1lb249RmFsc2UpXG5cbnBsdC50aWdodF9sYXlvdXQoKVxucGx0LnNob3coKSJ9
</script>
</div>
</section>
<section id="quadratic-fitting-from-scratch-matrix-method" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-fitting-from-scratch-matrix-method">4.2 Quadratic Fitting from Scratch (Matrix Method)</h3>
<p>Let’s implement quadratic fitting without using <code>polyfit</code> to show that it’s just an extension of the linear approach.</p>
<div>
<div id="pyodide-11" class="exercise-cell">

</div>
<script type="pyodide-11-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEZvciBxdWFkcmF0aWMgZml0OiB5ID0gYiArIG0xKnggKyBtMip4XjJcbiMgRGVzaWduIG1hdHJpeCBoYXMgMyBjb2x1bW5zOiBbMSwgeCwgeF4yXVxuXG5uID0gbGVuKHhfY3VydmVkKVxuWF9xdWFkID0gbnAuY29sdW1uX3N0YWNrKFtcbiAgICBucC5vbmVzKG4pLCAgICAgICMgQ29sdW1uIDE6IGNvbnN0YW50IChmb3IgaW50ZXJjZXB0IGIpXG4gICAgeF9jdXJ2ZWQsICAgICAgICAjIENvbHVtbiAyOiB4IChmb3IgbGluZWFyIHRlcm0gbTEpXG4gICAgeF9jdXJ2ZWQqKjIgICAgICAjIENvbHVtbiAzOiB4XjIgKGZvciBxdWFkcmF0aWMgdGVybSBtMilcbl0pXG5cbnByaW50KFwiRGVzaWduIG1hdHJpeCBmb3IgcXVhZHJhdGljIGZpdCAoZmlyc3QgNSByb3dzKTpcIilcbnByaW50KFwiICAgICBbMSAgICAgIHggICAgICB4XjJdXCIpXG5wcmludChYX3F1YWRbOjVdKVxucHJpbnQoZlwiXFxuU2hhcGU6IHtYX3F1YWQuc2hhcGV9XCIpXG5cbiMgU29sdmUgdXNpbmcgbm9ybWFsIGVxdWF0aW9uczogYmV0YSA9IChYXlQgWCleLTEgWF5UIHlcbmJldGFfcXVhZCA9IG5wLmxpbmFsZy5zb2x2ZShYX3F1YWQuVCBAIFhfcXVhZCwgWF9xdWFkLlQgQCB5X2N1cnZlZClcblxuYl9xdWFkID0gYmV0YV9xdWFkWzBdICAgIyBpbnRlcmNlcHRcbm0xX3F1YWQgPSBiZXRhX3F1YWRbMV0gICMgY29lZmZpY2llbnQgb2YgeFxubTJfcXVhZCA9IGJldGFfcXVhZFsyXSAgIyBjb2VmZmljaWVudCBvZiB4XjJcblxucHJpbnQoZlwiXFxuUXVhZHJhdGljIG1vZGVsIChmcm9tIHNjcmF0Y2gpOlwiKVxucHJpbnQoZlwiICB5ID0ge2JfcXVhZDouNGZ9ICsge20xX3F1YWQ6LjRmfSp4ICsge20yX3F1YWQ6LjRmfSp4wrJcIilcblxucHJpbnQoZlwiXFxuUXVhZHJhdGljIG1vZGVsIChmcm9tIHBvbHlmaXQpOlwiKVxucHJpbnQoZlwiICB5ID0ge2NvZWZmc19kZWcyWzJdOi40Zn0gKyB7Y29lZmZzX2RlZzJbMV06LjRmfSp4ICsge2NvZWZmc19kZWcyWzBdOi40Zn0qeMKyXCIpXG5cbnByaW50KGZcIlxcblZlcmlmaWNhdGlvbiAoY29lZmZpY2llbnRzIG1hdGNoKTpcIilcbnByaW50KGZcIiAgYjoge25wLmlzY2xvc2UoYl9xdWFkLCBjb2VmZnNfZGVnMlsyXSl9XCIpXG5wcmludChmXCIgIG0xOiB7bnAuaXNjbG9zZShtMV9xdWFkLCBjb2VmZnNfZGVnMlsxXSl9XCIpXG5wcmludChmXCIgIG0yOiB7bnAuaXNjbG9zZShtMl9xdWFkLCBjb2VmZnNfZGVnMlswXSl9XCIpIn0=
</script>
</div>
</section>
</section>
<section id="practical-example-real-data-with-multiple-models" class="level2">
<h2 class="anchored" data-anchor-id="practical-example-real-data-with-multiple-models">6. Practical Example: Real Data with Multiple Models</h2>
<p>Let’s combine everything we’ve learned by fitting a real-world-ish scenario with multiple polynomial degrees and comparing them.</p>
<div>
<div id="pyodide-12" class="exercise-cell">

</div>
<script type="pyodide-12-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEV4YW1wbGU6IEZpdG5lc3MgZGF0YSAtIG1pbnV0ZXMgb2YgZXhlcmNpc2UgcGVyIGRheSB2cy4gcmVzdGluZyBoZWFydCByYXRlIGltcHJvdmVtZW50XG4jIChJbnZlcnNlIHJlbGF0aW9uc2hpcDogbW9yZSBleGVyY2lzZSAtPiBsb3dlciBoZWFydCByYXRlKVxuXG5uX3NhbXBsZXMgPSAyNVxubWludXRlc19leGVyY2lzZWQgPSBucC5hcnJheShbMTAsIDIwLCAzMCwgMzUsIDQwLCAxNSwgNDUsIDI1LCA1MCwgMzAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAzNSwgNTUsIDIwLCA0MCwgNTAsIDYwLCAyNSwgNDUsIDU1LCAzMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDM4LCA0MiwgNDgsIDY1LCAyMl0pXG5cbiMgUmVsYXRpb25zaGlwOiBoZWFydF9yYXRlX2ltcHJvdmVtZW50ID0gNzAgLSAxLjIqbWludXRlcyAtIDAuMDEqbWludXRlc14yICsgbm9pc2VcbmhlYXJ0X3JhdGVfaW1wcm92ZW1lbnQgPSA3MCAtIDEuMiptaW51dGVzX2V4ZXJjaXNlZCAtIDAuMDEqKG1pbnV0ZXNfZXhlcmNpc2VkKioyKSArIFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgcm5nLm5vcm1hbCgwLCAzLCBuX3NhbXBsZXMpXG5cbiMgS2VlcCBpdCByZWFsaXN0aWMgKG5vbi1uZWdhdGl2ZSlcbmhlYXJ0X3JhdGVfaW1wcm92ZW1lbnQgPSBucC5tYXhpbXVtKGhlYXJ0X3JhdGVfaW1wcm92ZW1lbnQsIDApXG5cbmRmX2ZpdG5lc3MgPSBwZC5EYXRhRnJhbWUoe1xuICAgICdtaW51dGVzJzogbWludXRlc19leGVyY2lzZWQsXG4gICAgJ2ltcHJvdmVtZW50JzogaGVhcnRfcmF0ZV9pbXByb3ZlbWVudFxufSlcblxucHJpbnQoXCJGaXRuZXNzIERhdGEgKGZpcnN0IDEwIHJvd3MpOlwiKVxucHJpbnQoZGZfZml0bmVzcy5oZWFkKDEwKSlcbnByaW50KGZcIlxcbkRhdGFzZXQgc2l6ZToge2xlbihkZl9maXRuZXNzKX0gc2FtcGxlc1wiKVxuXG4jIFBsb3QgdGhlIHJhdyBkYXRhXG5wbHQuZmlndXJlKGZpZ3NpemU9KDEwLCA2KSlcbnBsdC5zY2F0dGVyKGRmX2ZpdG5lc3NbJ21pbnV0ZXMnXSwgZGZfZml0bmVzc1snaW1wcm92ZW1lbnQnXSwgXG4gICAgICAgICAgICBzPTEwMCwgYWxwaGE9MC42LCBjb2xvcj0nY29yYWwnLCBlZGdlY29sb3JzPSdibGFjaycsIGxpbmV3aWR0aD0xKVxucGx0LnhsYWJlbCgnTWludXRlcyBvZiBFeGVyY2lzZScsIGZvbnRzaXplPTEyKVxucGx0LnlsYWJlbCgnUmVzdGluZyBIZWFydCBSYXRlIEltcHJvdmVtZW50IChicG0pJywgZm9udHNpemU9MTIpXG5wbHQudGl0bGUoJ1JhdyBEYXRhOiBFeGVyY2lzZSB2cy4gSGVhcnQgUmF0ZSBJbXByb3ZlbWVudCcsIGZvbnRzaXplPTEzLCBmb250d2VpZ2h0PSdib2xkJylcbnBsdC5ncmlkKGFscGhhPTAuMylcbnBsdC50aWdodF9sYXlvdXQoKVxucGx0LnNob3coKSJ9
</script>
</div>
<div>
<div id="pyodide-13" class="exercise-cell">

</div>
<script type="pyodide-13-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIEZpdCBwb2x5bm9taWFscyBvZiBkaWZmZXJlbnQgZGVncmVlc1xueF9maXRuZXNzID0gZGZfZml0bmVzc1snbWludXRlcyddLnZhbHVlc1xueV9maXRuZXNzID0gZGZfZml0bmVzc1snaW1wcm92ZW1lbnQnXS52YWx1ZXNcblxuZGVncmVlcyA9IFsxLCAyLCAzLCA0XVxuZml0cyA9IHt9XG5yX3NxdWFyZWRfdmFsdWVzID0ge31cblxuZm9yIGRlZ3JlZSBpbiBkZWdyZWVzOlxuICAgIGNvZWZmcyA9IG5wLnBvbHlmaXQoeF9maXRuZXNzLCB5X2ZpdG5lc3MsIGRlZ3JlZSlcbiAgICBmaXRzW2RlZ3JlZV0gPSBucC5wb2x5MWQoY29lZmZzKVxuICAgIFxuICAgICMgQ2FsY3VsYXRlIFLCslxuICAgIHlfcHJlZCA9IGZpdHNbZGVncmVlXSh4X2ZpdG5lc3MpXG4gICAgc3NfcmVzID0gbnAuc3VtKCh5X2ZpdG5lc3MgLSB5X3ByZWQpKioyKVxuICAgIHNzX3RvdCA9IG5wLnN1bSgoeV9maXRuZXNzIC0gbnAubWVhbih5X2ZpdG5lc3MpKSoqMilcbiAgICByMiA9IDEgLSAoc3NfcmVzIC8gc3NfdG90KVxuICAgIHJfc3F1YXJlZF92YWx1ZXNbZGVncmVlXSA9IHIyXG4gICAgXG4gICAgcHJpbnQoZlwiRGVncmVlIHtkZWdyZWV9OiBSwrIgPSB7cjI6LjZmfVwiKVxuICAgIHByaW50KGZcIiAgRXF1YXRpb246IHtmaXRzW2RlZ3JlZV19XCIpXG4gICAgcHJpbnQoKVxuXG4jIEZpbmQgYmVzdCBtb2RlbFxuYmVzdF9kZWdyZWUgPSBtYXgocl9zcXVhcmVkX3ZhbHVlcywga2V5PXJfc3F1YXJlZF92YWx1ZXMuZ2V0KVxucHJpbnQoZlwiQmVzdCBmaXQgYnkgUsKyOiBEZWdyZWUge2Jlc3RfZGVncmVlfSB3aXRoIFLCsiA9IHtyX3NxdWFyZWRfdmFsdWVzW2Jlc3RfZGVncmVlXTouNmZ9XCIpIn0=
</script>
</div>
<div>
<div id="pyodide-14" class="exercise-cell">

</div>
<script type="pyodide-14-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiLilrYgQ3RybC9DbWQrRW50ZXIgfCDih6UgQ3RybC9DbWQrXSB8IOKHpCBDdHJsL0NtZCtbIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIFZpc3VhbGl6ZSBhbGwgbW9kZWxzIHRvZ2V0aGVyXG5maWcsIGF4ZXMgPSBwbHQuc3VicGxvdHMoMiwgMiwgZmlnc2l6ZT0oMTQsIDEwKSlcbmF4ZXMgPSBheGVzLmZsYXR0ZW4oKVxuXG54X3Ntb290aCA9IG5wLmxpbnNwYWNlKHhfZml0bmVzcy5taW4oKSwgeF9maXRuZXNzLm1heCgpLCAyMDApXG5jb2xvcnMgPSBbJ3JlZCcsICdncmVlbicsICdibHVlJywgJ3B1cnBsZSddXG5cbmZvciBpZHgsIGRlZ3JlZSBpbiBlbnVtZXJhdGUoZGVncmVlcyk6XG4gICAgYXggPSBheGVzW2lkeF1cbiAgICBcbiAgICAjIFBsb3QgZGF0YVxuICAgIGF4LnNjYXR0ZXIoeF9maXRuZXNzLCB5X2ZpdG5lc3MsIHM9MTAwLCBhbHBoYT0wLjYsIGNvbG9yPSdjb3JhbCcsIFxuICAgICAgICAgICAgICAgZWRnZWNvbG9ycz0nYmxhY2snLCBsaW5ld2lkdGg9MSwgbGFiZWw9J0RhdGEnLCB6b3JkZXI9MylcbiAgICBcbiAgICAjIFBsb3QgZml0XG4gICAgeV9zbW9vdGggPSBmaXRzW2RlZ3JlZV0oeF9zbW9vdGgpXG4gICAgYXgucGxvdCh4X3Ntb290aCwgeV9zbW9vdGgsIGNvbG9yPWNvbG9yc1tpZHhdLCBsaW5ld2lkdGg9Mi41LCBcbiAgICAgICAgICAgIGxhYmVsPWYnRGVncmVlIHtkZWdyZWV9IGZpdCcsIHpvcmRlcj0yKVxuICAgIFxuICAgICMgUGxvdCByZXNpZHVhbHNcbiAgICB5X3ByZWQgPSBmaXRzW2RlZ3JlZV0oeF9maXRuZXNzKVxuICAgIGZvciB4aSwgeWksIHlwaSBpbiB6aXAoeF9maXRuZXNzLCB5X2ZpdG5lc3MsIHlfcHJlZCk6XG4gICAgICAgIGF4LnBsb3QoW3hpLCB4aV0sIFt5aSwgeXBpXSwgJ2dyYXknLCBhbHBoYT0wLjMsIGxpbmV3aWR0aD0wLjgpXG4gICAgXG4gICAgYXguc2V0X3hsYWJlbCgnTWludXRlcyBvZiBFeGVyY2lzZScsIGZvbnRzaXplPTExKVxuICAgIGF4LnNldF95bGFiZWwoJ0hlYXJ0IFJhdGUgSW1wcm92ZW1lbnQgKGJwbSknLCBmb250c2l6ZT0xMSlcbiAgICBheC5zZXRfdGl0bGUoZidQb2x5bm9taWFsIERlZ3JlZSB7ZGVncmVlfSAoUsKyID0ge3Jfc3F1YXJlZF92YWx1ZXNbZGVncmVlXTouNGZ9KScsIFxuICAgICAgICAgICAgICAgIGZvbnR3ZWlnaHQ9J2JvbGQnLCBmb250c2l6ZT0xMilcbiAgICBheC5sZWdlbmQobG9jPSdiZXN0JylcbiAgICBheC5ncmlkKGFscGhhPTAuMylcblxucGx0LnRpZ2h0X2xheW91dCgpXG5wbHQuc2hvdygpXG5cbnByaW50KFwiXFxuT2JzZXJ2YXRpb25zOlwiKVxucHJpbnQoXCLigKIgRGVncmVlIDEgKGxpbmVhcikgbWlzc2VzIHRoZSBjdXJ2YXR1cmVcIilcbnByaW50KFwi4oCiIERlZ3JlZSAyIChxdWFkcmF0aWMpIGNhcHR1cmVzIHRoZSBtYWluIHRyZW5kIHJlYXNvbmFibHkgd2VsbFwiKVxucHJpbnQoXCLigKIgRGVncmVlIDMgYW5kIGhpZ2hlciBtYXkgYmUgb3ZlcmZpdHRpbmcgKGZpdHRpbmcgbm9pc2UpXCIpXG5wcmludChcIuKAoiBUaGUgcXVhZHJhdGljIG1vZGVsIChkZWdyZWUgMikgaXMgbGlrZWx5IHRoZSBiZXN0IGNob2ljZSBoZXJlXCIpIn0=
</script>
</div>
</section>
<section id="quick-reference-common-workflows" class="level2">
<h2 class="anchored" data-anchor-id="quick-reference-common-workflows">8. Quick Reference: Common Workflows</h2>
<section id="workflow-1-quick-polynomial-fit" class="level3">
<h3 class="anchored" data-anchor-id="workflow-1-quick-polynomial-fit">Workflow 1: Quick Polynomial Fit</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Your data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([...])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([...])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a polynomial (degree 2 for quadratic)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>coeffs <span class="op">=</span> np.polyfit(x, y, degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> poly(x)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>x_smooth <span class="op">=</span> np.linspace(x.<span class="bu">min</span>(), x.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.plot(x_smooth, poly(x_smooth), <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Fit'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="workflow-2-evaluate-multiple-models" class="level3">
<h3 class="anchored" data-anchor-id="workflow-2-evaluate-multiple-models">Workflow 2: Evaluate Multiple Models</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> degree <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    coeffs <span class="op">=</span> np.polyfit(x, y, degree)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> np.poly1d(coeffs)(x)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    ss_res <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_pred)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ss_tot <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> np.mean(y))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (ss_res <span class="op">/</span> ss_tot)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss">: R² = </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="workflow-3-manual-implementation-from-scratch" class="level3">
<h3 class="anchored" data-anchor-id="workflow-3-manual-implementation-from-scratch">Workflow 3: Manual Implementation (From Scratch)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For linear fit</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(<span class="bu">len</span>(x)), x])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.linalg.solve(X.T <span class="op">@</span> X, X.T <span class="op">@</span> y)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>b, m <span class="op">=</span> beta</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> m <span class="op">*</span> x <span class="op">+</span> b</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="practice-problems" class="level2">
<h2 class="anchored" data-anchor-id="practice-problems">9. Practice Problems</h2>
<section id="problem-1-temperature-vs.-ice-cream-sales" class="level3">
<h3 class="anchored" data-anchor-id="problem-1-temperature-vs.-ice-cream-sales">Problem 1: Temperature vs.&nbsp;Ice Cream Sales</h3>
<p>Generate synthetic data where ice cream sales increase with temperature, then fit both linear and quadratic models. Which fits better? Why?</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> np.linspace(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">20</span>) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">15</span><span class="op">*</span>temp <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>temp<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">20</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Fit degree 1 and degree 2 polynomials</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate R² for each</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot both fits</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Which is better?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="problem-2-implement-cubic-fitting-from-scratch" class="level3">
<h3 class="anchored" data-anchor-id="problem-2-implement-cubic-fitting-from-scratch">Problem 2: Implement Cubic Fitting from Scratch</h3>
<p>Using the matrix method (not <code>polyfit</code>), fit a cubic polynomial (<span class="math inline">\(y = b + m_1x + m_2x^2 + m_3x^3\)</span>) to the curved data.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: Design matrix should have 4 columns: [1, x, x², x³]</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Then solve: beta = np.linalg.solve(X.T @ X, X.T @ y)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="problem-3-predictions" class="level3">
<h3 class="anchored" data-anchor-id="problem-3-predictions">Problem 3: Predictions</h3>
<p>Using the house price model from earlier, predict the price for: - A 1200 sqft house - A 2500 sqft house</p>
<p>Do your predictions seem reasonable?</p>
</section>
<section id="problem-4-overfitting-investigation" class="level3">
<h3 class="anchored" data-anchor-id="problem-4-overfitting-investigation">Problem 4: Overfitting Investigation</h3>
<p>Fit polynomials of degree 1 through 10 to a dataset and plot how <span class="math inline">\(R^2\)</span> changes. At what degree does the <span class="math inline">\(R^2\)</span> stop improving meaningfully?</p>


<!-- -->

<script type="pyodide-data">
eyJvcHRpb25zIjp7ImVudiI6eyJQTE9UTFlfUkVOREVSRVIiOiJwbG90bHlfbWltZXR5cGUifSwiaW5kZXhVUkwiOiJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yOC4xL2Z1bGwvIn0sInBhY2thZ2VzIjp7InBrZ3MiOlsicHlvZGlkZV9odHRwIiwibWljcm9waXAiLCJpcHl0aG9uIl19fQ==
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJweW9kaWRlLTE0IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTQgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTE0LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTQtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xNCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEzIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTMgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEzLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTMtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMyA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEyIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTIgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEyLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTItY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMiA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTExIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTEgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTExLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTEtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMSA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTEsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEwIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfcHlvZGlkZV9lZGl0b3JfMTAgPSB7XG4gIGNvbnN0IHsgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLTEwLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMTAtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgUHlvZGlkZUV4ZXJjaXNlRWRpdG9yKFxuICAgIHB5b2RpZGVPanMucHlvZGlkZVByb21pc2UsXG4gICAgYmxvY2suY29kZSxcbiAgICBvcHRpb25zXG4gICk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fcHlvZGlkZV92YWx1ZV8xMCA9IHB5b2RpZGVPanMucHJvY2VzcyhfcHlvZGlkZV9lZGl0b3JfMTAsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTkiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl85ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS05LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtOS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzkgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzksIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTgiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl84ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS04LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtOC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzggPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzgsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTciLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl83ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS03LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzcgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTYiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl82ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS02LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzYgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl81ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS01LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzUgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTQiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl80ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS00LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzQgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTMiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8zID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0zLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzMgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTIiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8yID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0yLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzIgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8xID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0xLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzEgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzEsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLXByZWx1ZGUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJweW9kaWRlT2pzID0ge1xuICBjb25zdCB7XG4gICAgUHlvZGlkZUV2YWx1YXRvcixcbiAgICBQeW9kaWRlRW52aXJvbm1lbnRNYW5hZ2VyLFxuICAgIHNldHVwUHl0aG9uLFxuICAgIHN0YXJ0UHlvZGlkZVdvcmtlcixcbiAgICBiNjREZWNvZGUsXG4gICAgY29sbGFwc2VQYXRoLFxuICB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcblxuICBjb25zdCBzdGF0dXNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctc3RhdHVzXCIpO1xuICBjb25zdCBpbmRpY2F0b3JDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpbmRpY2F0b3JDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImQtbm9uZVwiKTtcblxuICBsZXQgc3RhdHVzVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgc3RhdHVzVGV4dC5jbGFzc0xpc3QgPSBcImV4ZXJjaXNlLWxvYWRpbmctZGV0YWlsc1wiO1xuICBzdGF0dXNUZXh0ID0gc3RhdHVzQ29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXR1c1RleHQpO1xuICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYEluaXRpYWxpc2VgO1xuXG4gIC8vIEhvaXN0IGluZGljYXRvciBvdXQgZnJvbSBmaW5hbCBzbGlkZSB3aGVuIHJ1bm5pbmcgdW5kZXIgcmV2ZWFsXG4gIGNvbnN0IHJldmVhbFN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsIC5leGVyY2lzZS1sb2FkaW5nLWluZGljYXRvclwiKTtcbiAgaWYgKHJldmVhbFN0YXR1cykge1xuICAgIHJldmVhbFN0YXR1cy5yZW1vdmUoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJldmVhbCA+IC5zbGlkZXNcIikuYXBwZW5kQ2hpbGQocmV2ZWFsU3RhdHVzKTtcbiAgfVxuXG4gIC8vIE1ha2UgYW55IHJldmVhbCBzbGlkZXMgd2l0aCBsaXZlIGNlbGxzIHNjcm9sbGFibGVcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXZlYWwgLmV4ZXJjaXNlLWNlbGxcIikuZm9yRWFjaCgoZWwpID0+IHtcbiAgICBlbC5jbG9zZXN0KCdzZWN0aW9uLnNsaWRlJykuY2xhc3NMaXN0LmFkZChcInNjcm9sbGFibGVcIik7XG4gIH0pXG5cbiAgLy8gUHlvZGlkZSBzdXBwbGVtZW50YWwgZGF0YSBhbmQgb3B0aW9uc1xuICBjb25zdCBkYXRhQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJweW9kaWRlLWRhdGFcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShiNjREZWNvZGUoZGF0YUNvbnRlbnQpKTtcblxuICAvLyBHcmFiIGxpc3Qgb2YgcmVzb3VyY2VzIHRvIGJlIGRvd25sb2FkZWRcbiAgY29uc3QgZmlsZXNDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInZmcy1maWxlXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgZmlsZXMgPSBKU09OLnBhcnNlKGI2NERlY29kZShmaWxlc0NvbnRlbnQpKTtcblxuICBsZXQgcHlvZGlkZVByb21pc2UgPSAoYXN5bmMgKCkgPT4ge1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgUHlvZGlkZWA7XG4gICAgY29uc3QgcHlvZGlkZSA9IGF3YWl0IHN0YXJ0UHlvZGlkZVdvcmtlcihkYXRhLm9wdGlvbnMpO1xuXG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiBtaWNyb3BpcGA7XG4gICAgYXdhaXQgcHlvZGlkZS5sb2FkUGFja2FnZShcIm1pY3JvcGlwXCIpO1xuICAgIGNvbnN0IG1pY3JvcGlwID0gYXdhaXQgcHlvZGlkZS5weWltcG9ydChcIm1pY3JvcGlwXCIpO1xuICAgIGF3YWl0IGRhdGEucGFja2FnZXMucGtncy5tYXAoKHBrZykgPT4gKCkgPT4ge1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBwYWNrYWdlOiAke3BrZ31gO1xuICAgICAgcmV0dXJuIG1pY3JvcGlwLmluc3RhbGwocGtnKTtcbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICBhd2FpdCBtaWNyb3BpcC5kZXN0cm95KCk7XG5cbiAgICAvLyBEb3dubG9hZCBhbmQgaW5zdGFsbCByZXNvdXJjZXNcbiAgICBhd2FpdCBmaWxlcy5tYXAoKGZpbGUpID0+IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLnN1YnN0cmluZyhmaWxlLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcbiAgICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgRG93bmxvYWRpbmcgcmVzb3VyY2U6ICR7bmFtZX1gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW4ndCBkb3dubG9hZCBcXGAke2ZpbGV9XFxgLiBFcnJvciAke3Jlc3BvbnNlLnN0YXR1c306IFwiJHtyZXNwb25zZS5zdGF0dXNUZXh0fVwiLmApO1xuICAgICAgfVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7XG5cbiAgICAgIC8vIFN0b3JlIFVSTHMgaW4gdGhlIGN3ZCB3aXRob3V0IGFueSBzdWJkaXJlY3Rvcnkgc3RydWN0dXJlXG4gICAgICBpZiAoZmlsZS5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICBmaWxlID0gbmFtZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29sbGFwc2UgaGlnaGVyIGRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGZpbGUgPSBjb2xsYXBzZVBhdGgoZmlsZSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkaXJlY3RvcnkgdHJlZSwgaWdub3JpbmcgXCJkaXJlY3RvcnkgZXhpc3RzXCIgVkZTIGVycm9yc1xuICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpO1xuICAgICAgbGV0IHBhdGggPSAnJztcbiAgICAgIHdoaWxlIChwYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHBhdGggKz0gcGFydHMuc2hpZnQoKSArICcvJztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBweW9kaWRlLkZTLm1rZGlyKHBhdGgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKGUubmFtZSAhPT0gXCJFcnJub0Vycm9yXCIpIHRocm93IGU7XG4gICAgICAgICAgaWYgKGUuZXJybm8gIT09IDIwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHRQdHIgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuX3N0cmVycm9yKGUuZXJybm8pO1xuICAgICAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcHlvZGlkZS5fbW9kdWxlLlVURjhUb1N0cmluZyhlcnJvclRleHRQdHIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yICR7ZS5lcnJub30gXCIke2Vycm9yVGV4dH1cIi5gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV3JpdGUgdGhpcyBmaWxlIHRvIHRoZSBWRlNcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBweW9kaWRlLkZTLndyaXRlRmlsZShmaWxlLCBuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChlLm5hbWUgIT09IFwiRXJybm9FcnJvclwiKSB0aHJvdyBlO1xuICAgICAgICBjb25zdCBlcnJvclRleHRQdHIgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuX3N0cmVycm9yKGUuZXJybm8pO1xuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuVVRGOFRvU3RyaW5nKGVycm9yVGV4dFB0cik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZXN5c3RlbSBFcnJvciAke2UuZXJybm99IFwiJHtlcnJvclRleHR9XCIuYCk7XG4gICAgICB9XG4gICAgfSkucmVkdWNlKChjdXIsIG5leHQpID0+IGN1ci50aGVuKG5leHQpLCBQcm9taXNlLnJlc29sdmUoKSk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYFB5b2RpZGUgZW52aXJvbm1lbnQgc2V0dXBgO1xuICAgIGF3YWl0IHNldHVwUHl0aG9uKHB5b2RpZGUpO1xuXG4gICAgc3RhdHVzVGV4dC5yZW1vdmUoKTtcbiAgICBpZiAoc3RhdHVzQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA9PSAwKSB7XG4gICAgICBzdGF0dXNDb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHB5b2RpZGU7XG4gIH0pKCkuY2F0Y2goKGVycikgPT4ge1xuICAgIHN0YXR1c1RleHQuc3R5bGUuY29sb3IgPSBcInZhcigtLWV4ZXJjaXNlLWVkaXRvci1obC1lciwgI0FEMDAwMClcIjtcbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gZXJyLm1lc3NhZ2U7XG4gICAgLy9pbmRpY2F0b3JDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5zcGlubmVyLWdyb3dcIikuY2xhc3NMaXN0LmFkZChcImQtbm9uZVwiKTtcbiAgICB0aHJvdyBlcnI7XG4gIH0pO1xuXG4gIC8vIEtlZXAgdHJhY2sgb2YgaW5pdGlhbCBPSlMgYmxvY2sgcmVuZGVyXG4gIGNvbnN0IHJlbmRlcmVkT2pzID0ge307XG5cbiAgY29uc3QgcHJvY2VzcyA9IGFzeW5jIChjb250ZXh0LCBpbnB1dHMpID0+IHtcbiAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgcHlvZGlkZVByb21pc2U7XG4gICAgY29uc3QgZXZhbHVhdG9yID0gbmV3IFB5b2RpZGVFdmFsdWF0b3IocHlvZGlkZSwgY29udGV4dCk7XG4gICAgYXdhaXQgZXZhbHVhdG9yLnByb2Nlc3MoaW5wdXRzKTtcbiAgICByZXR1cm4gZXZhbHVhdG9yLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHlvZGlkZVByb21pc2UsXG4gICAgcmVuZGVyZWRPanMsXG4gICAgcHJvY2VzcyxcbiAgfTtcbn1cbiJ9XX0=
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../18";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/FTurci\.github\.io\/intro-coding-data-analysis\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Simple Curve Fitting in Python</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>In previous lectures, we learned how to visualize data using <span class="in">`matplotlib`</span> and <span class="in">`pandas`</span>, and how to perform numerical computations with <span class="in">`numpy`</span>. A natural next step is to ask: **can we find a mathematical model that describes the relationship between variables in our data?**</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>Curve fitting is the process of constructing a mathematical function that passes through (or near) a set of data points. This is one of the fundamental techniques in data analysis and has applications across science, engineering, and business:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Physics**: Fitting experimental data to theoretical models</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Economics**: Fitting economic indicators to predict trends</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Biology**: Modeling growth curves and drug concentration over time</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Finance**: Fitting price histories to predict future movements</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>In this lecture, we will learn:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The mathematical foundations of linear regression from scratch</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>How to implement linear fitting explicitly using numpy operations</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>How polynomial fittingextends the linear model</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>How to use numpy's <span class="in">`polyfit`</span> function for practical applications</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>We will build understanding progressively, starting with the simplest case and building up to more complex models.</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">42</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Linear Regression: The Simplest Curve Fitting Model</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>Let's start with the simplest case: fitting a **linear model** to data. The goal is to find a line that best describes the relationship between two variables.</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Linear Model</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>The linear model assumes that $y$ (the dependent variable) is related to $x$ (the independent variable) by:</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>$$y = mx + b$$</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$m$ is the **slope** (how much $y$ changes when $x$ increases by 1)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$b$ is the **intercept** (the value of $y$ when $x = 0$)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>In practice, real data rarely falls exactly on a line. There is always some **noise** or **error**. So the model is:</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>$$y_i = mx_i + b + \epsilon_i$$</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>where $\epsilon_i$ represents the error in observation $i$.</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Goal: Minimize the Residuals</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>When we **fit** a line to data, we want to find the values of $m$ and $b$ that make the **residuals** (the differences between observed and predicted values) as small as possible.</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>For each data point $i$:</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Observed value**: $y_i$</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Predicted value**: $\hat{y}_i = mx_i + b$</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Residual**: $r_i = y_i - \hat{y}_i$</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>A common approach is **least squares fitting**, which minimizes the sum of squared residuals:</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>$$\text{Loss} = \sum_{i=1}^{n} (y_i - (mx_i + b))^2$$</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>This loss function is convex, which means it has a single minimum—the unique best solution.</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Closed-Form Solution (Normal Equations)</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>Calculus tells us that the minimum of the loss function occurs when its derivatives with respect to $m$ and $b$ are zero. Solving these equations gives us the **normal equations**, which directly compute the optimal $m$ and $b$:</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>$$m = \frac{n\sum x_i y_i - \sum x_i \sum y_i}{n\sum x_i^2 - (\sum x_i)^2}$$</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>$$b = \frac{\sum y_i - m\sum x_i}{n}$$</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>In alternative form (using means):</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>$$m = \frac{\text{Cov}(x, y)}{\text{Var}(x)}, \quad b = \bar{y} - m\bar{x}$$</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>These formulas give us the optimal slope and intercept without iterative optimization!</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. A Simple Example: House Prices vs. Square Footage</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>Let's create a simple dataset and fit it by hand to understand the process concretely.</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate synthetic house price data</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="co"># True relationship: price = 200 * sqft + 50000 (plus some noise)</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>n_houses <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>sqft <span class="op">=</span> np.array([<span class="dv">1200</span>, <span class="dv">1500</span>, <span class="dv">1800</span>, <span class="dv">900</span>, <span class="dv">2100</span>, <span class="dv">1050</span>, <span class="dv">1600</span>, <span class="dv">2200</span>, <span class="dv">1400</span>, <span class="dv">2500</span>,</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">1100</span>, <span class="dv">1700</span>, <span class="dv">2000</span>, <span class="dv">1300</span>, <span class="dv">1900</span>, <span class="dv">1400</span>, <span class="dv">2300</span>, <span class="dv">1100</span>, <span class="dv">2100</span>, <span class="dv">1600</span>])</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Price has a linear relationship with sqft, plus some random noise</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> <span class="dv">200</span> <span class="op">*</span> sqft <span class="op">+</span> <span class="dv">50000</span> <span class="op">+</span> rng.normal(<span class="dv">0</span>, <span class="dv">30000</span>, n_houses)</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for clarity</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>df_houses <span class="op">=</span> pd.DataFrame({<span class="st">'sqft'</span>: sqft, <span class="st">'price'</span>: price})</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_houses)</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's visualize the raw data</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>plt.scatter(df_houses[<span class="st">'sqft'</span>], df_houses[<span class="st">'price'</span>], s<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Square Footage'</span>)</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price (GBP)'</span>)</span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'House Prices vs. Square Footage (Raw Data)'</span>)</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of houses: </span><span class="sc">{</span><span class="bu">len</span>(df_houses)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean price: $</span><span class="sc">{</span>df_houses[<span class="st">'price'</span>]<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean sqft: </span><span class="sc">{</span>df_houses[<span class="st">'sqft'</span>]<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Implementing Linear Regression from Scratch</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>Now, let's implement linear regression using only numpy operations. We'll use the normal equations to compute the optimal slope and intercept directly.</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>**Method 1: Using the algebraic formula**</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_houses[<span class="st">'sqft'</span>].values</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_houses[<span class="st">'price'</span>].values</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the normal equations:</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="co"># m = (n * sum(xy) - sum(x) * sum(y)) / (n * sum(x^2) - (sum(x))^2)</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a><span class="co"># b = (sum(y) - m * sum(x)) / n</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>numerator_m <span class="op">=</span> n <span class="op">*</span> np.<span class="bu">sum</span>(x <span class="op">*</span> y) <span class="op">-</span> np.<span class="bu">sum</span>(x) <span class="op">*</span> np.<span class="bu">sum</span>(y)</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>denominator_m <span class="op">=</span> n <span class="op">*</span> np.<span class="bu">sum</span>(x<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> (np.<span class="bu">sum</span>(x))<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> numerator_m <span class="op">/</span> denominator_m</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> (np.<span class="bu">sum</span>(y) <span class="op">-</span> m <span class="op">*</span> np.<span class="bu">sum</span>(x)) <span class="op">/</span> n</span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Fitted equation: price = </span><span class="sc">{</span>m<span class="sc">:.2f}</span><span class="ss"> * sqft + </span><span class="sc">{</span>b<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation:"</span>)</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Slope (m) = </span><span class="sc">{</span>m<span class="sc">:.2f}</span><span class="ss">: Each additional sqft adds $</span><span class="sc">{</span>m<span class="sc">:.2f}</span><span class="ss"> to the price"</span>)</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Intercept (b) = $</span><span class="sc">{</span>b<span class="sc">:,.2f}</span><span class="ss">: Baseline price (when sqft = 0)"</span>)</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions for all x values</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> m <span class="op">*</span> x <span class="op">+</span> b</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute residuals</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>residuals <span class="op">=</span> y <span class="op">-</span> y_pred</span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sum of squared residuals and R-squared</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>ss_res <span class="op">=</span> np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>ss_tot <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> np.mean(y))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (ss_res <span class="op">/</span> ss_tot)</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum of Squared Residuals: </span><span class="sc">{</span>ss_res<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R-squared (Coefficient of Determination): </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation of R²:"</span>)</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Our model explains </span><span class="sc">{</span>r_squared<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% of the variance in prices"</span>)</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Values closer to 1.0 indicate better fit"</span>)</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot raw data</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y, s<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, label<span class="op">=</span><span class="st">'Actual data'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fitted line</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>x_line <span class="op">=</span> np.array([x.<span class="bu">min</span>(), x.<span class="bu">max</span>()])</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>y_line <span class="op">=</span> m <span class="op">*</span> x_line <span class="op">+</span> b</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>plt.plot(x_line, y_line, <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="ss">f'Fitted line: y = </span><span class="sc">{</span>m<span class="sc">:.2f}</span><span class="ss">x + </span><span class="sc">{</span>b<span class="sc">:,.0f}</span><span class="ss">'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw residuals as vertical lines</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> xi, yi, ypi <span class="kw">in</span> <span class="bu">zip</span>(x, y, y_pred):</span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>    plt.plot([xi, xi], [yi, ypi], <span class="st">'g--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y_pred, s<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'x'</span>, linewidths<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Predicted values'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Square Footage'</span>)</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Price (GBP)'</span>)</span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Linear Regression Fit (R² = </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss">)'</span>)</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 Matrix Form of Linear Regression</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>The normal equations can be written in **matrix form**, which is more general and extensible (we'll use this to fit polynomials later):</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>We want to solve:</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>$$\mathbf{X} \mathbf{\beta} = \mathbf{y}$$</span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{X}$ is the **design matrix** (augmented with a column of 1's for the intercept)</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{\beta}$ contains the parameters we want to estimate $<span class="co">[</span><span class="ot">b, m</span><span class="co">]</span>^T$</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{y}$ is the vector of observations</span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>The least-squares solution is:</span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>$$\mathbf{\beta} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{y}$$</span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>This is a more general formulation that works for any number of features!</span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the design matrix X (column of 1's for intercept, then x values)</span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a><span class="co"># X is shape (n, 2)</span></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(n), x])</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Design matrix X (first 5 rows):"</span>)</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X[:<span class="dv">5</span>])</span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Shape of X: </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of y: </span><span class="sc">{</span>y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve using the normal equations: beta = (X^T X)^-1 X^T y</span></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>XtX <span class="op">=</span> X.T <span class="op">@</span> X  <span class="co"># X transpose times X</span></span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>Xty <span class="op">=</span> X.T <span class="op">@</span> y  <span class="co"># X transpose times y</span></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve for beta</span></span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.linalg.solve(XtX, Xty)</span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>b_matrix <span class="op">=</span> beta[<span class="dv">0</span>]  <span class="co"># intercept</span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a>m_matrix <span class="op">=</span> beta[<span class="dv">1</span>]  <span class="co"># slope</span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Using matrix form:"</span>)</span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Intercept (b): </span><span class="sc">{</span>b_matrix<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Slope (m): </span><span class="sc">{</span>m_matrix<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Verification: Does matrix form match algebraic formula?"</span>)</span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - m: </span><span class="sc">{</span><span class="bu">abs</span>(m <span class="op">-</span> m_matrix) <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - b: </span><span class="sc">{</span><span class="bu">abs</span>(b <span class="op">-</span> b_matrix) <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Practical Implementation: NumPy's `polyfit`</span></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a>Rather than implementing the matrix math ourselves every time, numpy provides the <span class="in">`polyfit`</span> function, which fits a polynomial of specified degree to data. For linear regression, we use degree 1.</span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>**Syntax**: <span class="in">`np.polyfit(x, y, degree)`</span> returns the coefficients of the polynomial.</span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear fit using polyfit (degree 1)</span></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a>coeffs_linear <span class="op">=</span> np.polyfit(x, y, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Using np.polyfit(x, y, degree=1):"</span>)</span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coefficients: </span><span class="sc">{</span>coeffs_linear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Slope (coefficient of x): </span><span class="sc">{</span>coeffs_linear[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Intercept (constant term): </span><span class="sc">{</span>coeffs_linear[<span class="dv">1</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a polynomial function from the coefficients</span></span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a>poly_linear <span class="op">=</span> np.poly1d(coeffs_linear)</span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Polynomial function: </span><span class="sc">{</span>poly_linear<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Example: For a 1500 sqft house, predicted price = $</span><span class="sc">{</span>poly_linear(<span class="dv">1500</span>)<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify this matches our hand-computed values</span></span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Verification:"</span>)</span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  polyfit slope vs hand-computed: </span><span class="sc">{</span><span class="bu">abs</span>(coeffs_linear[<span class="dv">0</span>] <span class="op">-</span> m) <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  polyfit intercept vs hand-computed: </span><span class="sc">{</span><span class="bu">abs</span>(coeffs_linear[<span class="dv">1</span>] <span class="op">-</span> b) <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Extending the Model: Polynomial (Quadratic) Fitting</span></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>The linear model works well when the relationship is... well, linear. But many real-world relationships are curved. How can we extend our approach?</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### From Linear to Polynomial</span></span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>The beauty of the least-squares approach is that it's **not limited to linear relationships**. We can fit polynomials of any degree:</span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Degree 1 (Linear)**: $y = b + mx$</span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Degree 2 (Quadratic)**: $y = b + mx + cx^2$</span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Degree 3 (Cubic)**: $y = b + mx + cx^2 + dx^3$</span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**General degree n**: $y = b + m_1 x + m_2 x^2 + \cdots + m_n x^n$</span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why Does This Work Mathematically?</span></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>The key insight is that **even though** we're fitting to powers of $x$, **the problem is still linear in the parameters**. </span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>For the quadratic case, we can rewrite:</span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a>$$y = b + mx + cx^2$$</span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a>If we define $x_1 = x$ and $x_2 = x^2$, then:</span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>$$y = b + m x_1 + c x_2$$</span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a>This is now linear in $(b, m, c)$ and can be solved using the same matrix approach! We just construct the design matrix differently:</span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>$$\mathbf{X} = \begin{bmatrix} 1 &amp; x_1 &amp; x_1^2 <span class="sc">\\</span> 1 &amp; x_2 &amp; x_2^2 <span class="sc">\\</span> \vdots &amp; \vdots &amp; \vdots \end{bmatrix}$$</span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a>And everything else follows.</span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1 Example: Curved Relationship</span></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a>Let's create a dataset with a curved (quadratic) relationship and compare linear vs. quadratic fits.</span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate curved data: y = 1 + 2*x + 0.01*x^2 + noise</span></span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a><span class="co"># This represents a relationship that accelerates (e.g., distance vs time with acceleration)</span></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a>n_points <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a>x_curved <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">100</span>, n_points)</span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a><span class="co"># True quadratic relationship with noise</span></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a>y_curved <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x_curved <span class="op">+</span> <span class="fl">0.01</span><span class="op">*</span>(x_curved<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> rng.normal(<span class="dv">0</span>, <span class="dv">20</span>, n_points)</span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a>df_curved <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x_curved, <span class="st">'y'</span>: y_curved})</span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model (degree 1)</span></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a>coeffs_deg1 <span class="op">=</span> np.polyfit(x_curved, y_curved, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a>poly_deg1 <span class="op">=</span> np.poly1d(coeffs_deg1)</span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit quadratic model (degree 2)</span></span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a>coeffs_deg2 <span class="op">=</span> np.polyfit(x_curved, y_curved, deg<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a>poly_deg2 <span class="op">=</span> np.poly1d(coeffs_deg2)</span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fitted Models:"</span>)</span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Linear (degree 1):"</span>)</span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Equation: </span><span class="sc">{</span>poly_deg1<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Coefficients: b=</span><span class="sc">{</span>coeffs_deg1[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">, m=</span><span class="sc">{</span>coeffs_deg1[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Quadratic (degree 2):"</span>)</span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Equation: </span><span class="sc">{</span>poly_deg2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Coefficients: b=</span><span class="sc">{</span>coeffs_deg2[<span class="dv">2</span>]<span class="sc">:.4f}</span><span class="ss">, m=</span><span class="sc">{</span>coeffs_deg2[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">, c=</span><span class="sc">{</span>coeffs_deg2[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute R² for both</span></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>y_pred_deg1 <span class="op">=</span> poly_deg1(x_curved)</span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a>y_pred_deg2 <span class="op">=</span> poly_deg2(x_curved)</span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a>ss_tot <span class="op">=</span> np.<span class="bu">sum</span>((y_curved <span class="op">-</span> np.mean(y_curved))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a>r2_deg1 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.<span class="bu">sum</span>((y_curved <span class="op">-</span> y_pred_deg1)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> ss_tot</span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a>r2_deg2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.<span class="bu">sum</span>((y_curved <span class="op">-</span> y_pred_deg2)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> ss_tot</span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n\n</span><span class="ss">Model Comparison:"</span>)</span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Linear R²: </span><span class="sc">{</span>r2_deg1<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Quadratic R²: </span><span class="sc">{</span>r2_deg2<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Improvement: </span><span class="sc">{</span>(r2_deg2 <span class="op">-</span> r2_deg1)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize both fits</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a><span class="co"># Left plot: Linear fit</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>x_smooth <span class="op">=</span> np.linspace(x_curved.<span class="bu">min</span>(), x_curved.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>ax.scatter(x_curved, y_curved, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a>ax.plot(x_smooth, poly_deg1(x_smooth), <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="ss">f'Linear fit (R²=</span><span class="sc">{</span>r2_deg1<span class="sc">:.4f}</span><span class="ss">)'</span>)</span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Linear Model (Degree 1)'</span>)</span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a>ax.legend(frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Right plot: Quadratic fit</span></span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>ax.scatter(x_curved, y_curved, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a>ax.plot(x_smooth, poly_deg2(x_smooth), <span class="st">'g-'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="ss">f'Quadratic fit (R²=</span><span class="sc">{</span>r2_deg2<span class="sc">:.4f}</span><span class="ss">)'</span>)</span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>,)</span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>,)</span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Quadratic Model (Degree 2)'</span>)</span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>ax.legend(frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2 Quadratic Fitting from Scratch (Matrix Method)</span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a>Let's implement quadratic fitting without using <span class="in">`polyfit`</span> to show that it's just an extension of the linear approach.</span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a><span class="co"># For quadratic fit: y = b + m1*x + m2*x^2</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Design matrix has 3 columns: [1, x, x^2]</span></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(x_curved)</span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a>X_quad <span class="op">=</span> np.column_stack([</span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a>    np.ones(n),      <span class="co"># Column 1: constant (for intercept b)</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a>    x_curved,        <span class="co"># Column 2: x (for linear term m1)</span></span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a>    x_curved<span class="op">**</span><span class="dv">2</span>      <span class="co"># Column 3: x^2 (for quadratic term m2)</span></span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Design matrix for quadratic fit (first 5 rows):"</span>)</span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"     [1      x      x^2]"</span>)</span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_quad[:<span class="dv">5</span>])</span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Shape: </span><span class="sc">{</span>X_quad<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve using normal equations: beta = (X^T X)^-1 X^T y</span></span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a>beta_quad <span class="op">=</span> np.linalg.solve(X_quad.T <span class="op">@</span> X_quad, X_quad.T <span class="op">@</span> y_curved)</span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a>b_quad <span class="op">=</span> beta_quad[<span class="dv">0</span>]   <span class="co"># intercept</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a>m1_quad <span class="op">=</span> beta_quad[<span class="dv">1</span>]  <span class="co"># coefficient of x</span></span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a>m2_quad <span class="op">=</span> beta_quad[<span class="dv">2</span>]  <span class="co"># coefficient of x^2</span></span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Quadratic model (from scratch):"</span>)</span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  y = </span><span class="sc">{</span>b_quad<span class="sc">:.4f}</span><span class="ss"> + </span><span class="sc">{</span>m1_quad<span class="sc">:.4f}</span><span class="ss">*x + </span><span class="sc">{</span>m2_quad<span class="sc">:.4f}</span><span class="ss">*x²"</span>)</span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Quadratic model (from polyfit):"</span>)</span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  y = </span><span class="sc">{</span>coeffs_deg2[<span class="dv">2</span>]<span class="sc">:.4f}</span><span class="ss"> + </span><span class="sc">{</span>coeffs_deg2[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">*x + </span><span class="sc">{</span>coeffs_deg2[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">*x²"</span>)</span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Verification (coefficients match):"</span>)</span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  b: </span><span class="sc">{</span>np<span class="sc">.</span>isclose(b_quad, coeffs_deg2[<span class="dv">2</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  m1: </span><span class="sc">{</span>np<span class="sc">.</span>isclose(m1_quad, coeffs_deg2[<span class="dv">1</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  m2: </span><span class="sc">{</span>np<span class="sc">.</span>isclose(m2_quad, coeffs_deg2[<span class="dv">0</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Practical Example: Real Data with Multiple Models</span></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a>Let's combine everything we've learned by fitting a real-world-ish scenario with multiple polynomial degrees and comparing them.</span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Fitness data - minutes of exercise per day vs. resting heart rate improvement</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a><span class="co"># (Inverse relationship: more exercise -&gt; lower heart rate)</span></span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a>minutes_exercised <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">15</span>, <span class="dv">45</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">30</span>,</span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">30</span>,</span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">48</span>, <span class="dv">65</span>, <span class="dv">22</span>])</span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a><span class="co"># Relationship: heart_rate_improvement = 70 - 1.2*minutes - 0.01*minutes^2 + noise</span></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a>heart_rate_improvement <span class="op">=</span> <span class="dv">70</span> <span class="op">-</span> <span class="fl">1.2</span><span class="op">*</span>minutes_exercised <span class="op">-</span> <span class="fl">0.01</span><span class="op">*</span>(minutes_exercised<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a>                         rng.normal(<span class="dv">0</span>, <span class="dv">3</span>, n_samples)</span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep it realistic (non-negative)</span></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a>heart_rate_improvement <span class="op">=</span> np.maximum(heart_rate_improvement, <span class="dv">0</span>)</span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a>df_fitness <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a>    <span class="st">'minutes'</span>: minutes_exercised,</span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a>    <span class="st">'improvement'</span>: heart_rate_improvement</span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fitness Data (first 10 rows):"</span>)</span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_fitness.head(<span class="dv">10</span>))</span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Dataset size: </span><span class="sc">{</span><span class="bu">len</span>(df_fitness)<span class="sc">}</span><span class="ss"> samples"</span>)</span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the raw data</span></span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a>plt.scatter(df_fitness[<span class="st">'minutes'</span>], df_fitness[<span class="st">'improvement'</span>], </span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a>            s<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'coral'</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Minutes of Exercise'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Resting Heart Rate Improvement (bpm)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Raw Data: Exercise vs. Heart Rate Improvement'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit polynomials of different degrees</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a>x_fitness <span class="op">=</span> df_fitness[<span class="st">'minutes'</span>].values</span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a>y_fitness <span class="op">=</span> df_fitness[<span class="st">'improvement'</span>].values</span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a>fits <span class="op">=</span> {}</span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a>r_squared_values <span class="op">=</span> {}</span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> degree <span class="kw">in</span> degrees:</span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a>    coeffs <span class="op">=</span> np.polyfit(x_fitness, y_fitness, degree)</span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a>    fits[degree] <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate R²</span></span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> fits[degree](x_fitness)</span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a>    ss_res <span class="op">=</span> np.<span class="bu">sum</span>((y_fitness <span class="op">-</span> y_pred)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a>    ss_tot <span class="op">=</span> np.<span class="bu">sum</span>((y_fitness <span class="op">-</span> np.mean(y_fitness))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (ss_res <span class="op">/</span> ss_tot)</span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a>    r_squared_values[degree] <span class="op">=</span> r2</span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss">: R² = </span><span class="sc">{</span>r2<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Equation: </span><span class="sc">{</span>fits[degree]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Find best model</span></span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a>best_degree <span class="op">=</span> <span class="bu">max</span>(r_squared_values, key<span class="op">=</span>r_squared_values.get)</span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Best fit by R²: Degree </span><span class="sc">{</span>best_degree<span class="sc">}</span><span class="ss"> with R² = </span><span class="sc">{</span>r_squared_values[best_degree]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-516"><a href="#cb6-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{pyodide}</span></span>
<span id="cb6-517"><a href="#cb6-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| caption: "▶ Ctrl/Cmd+Enter | ⇥ Ctrl/Cmd+] | ⇤ Ctrl/Cmd+["</span></span>
<span id="cb6-518"><a href="#cb6-518" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize all models together</span></span>
<span id="cb6-519"><a href="#cb6-519" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb6-520"><a href="#cb6-520" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb6-521"><a href="#cb6-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-522"><a href="#cb6-522" aria-hidden="true" tabindex="-1"></a>x_smooth <span class="op">=</span> np.linspace(x_fitness.<span class="bu">min</span>(), x_fitness.<span class="bu">max</span>(), <span class="dv">200</span>)</span>
<span id="cb6-523"><a href="#cb6-523" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>, <span class="st">'purple'</span>]</span>
<span id="cb6-524"><a href="#cb6-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-525"><a href="#cb6-525" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, degree <span class="kw">in</span> <span class="bu">enumerate</span>(degrees):</span>
<span id="cb6-526"><a href="#cb6-526" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx]</span>
<span id="cb6-527"><a href="#cb6-527" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-528"><a href="#cb6-528" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot data</span></span>
<span id="cb6-529"><a href="#cb6-529" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x_fitness, y_fitness, s<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'coral'</span>, </span>
<span id="cb6-530"><a href="#cb6-530" aria-hidden="true" tabindex="-1"></a>               edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Data'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb6-531"><a href="#cb6-531" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-532"><a href="#cb6-532" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot fit</span></span>
<span id="cb6-533"><a href="#cb6-533" aria-hidden="true" tabindex="-1"></a>    y_smooth <span class="op">=</span> fits[degree](x_smooth)</span>
<span id="cb6-534"><a href="#cb6-534" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_smooth, y_smooth, color<span class="op">=</span>colors[idx], linewidth<span class="op">=</span><span class="fl">2.5</span>, </span>
<span id="cb6-535"><a href="#cb6-535" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="ss">f'Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss"> fit'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-536"><a href="#cb6-536" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-537"><a href="#cb6-537" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot residuals</span></span>
<span id="cb6-538"><a href="#cb6-538" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> fits[degree](x_fitness)</span>
<span id="cb6-539"><a href="#cb6-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> xi, yi, ypi <span class="kw">in</span> <span class="bu">zip</span>(x_fitness, y_fitness, y_pred):</span>
<span id="cb6-540"><a href="#cb6-540" aria-hidden="true" tabindex="-1"></a>        ax.plot([xi, xi], [yi, ypi], <span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb6-541"><a href="#cb6-541" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-542"><a href="#cb6-542" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Minutes of Exercise'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb6-543"><a href="#cb6-543" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Heart Rate Improvement (bpm)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb6-544"><a href="#cb6-544" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Polynomial Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss"> (R² = </span><span class="sc">{</span>r_squared_values[degree]<span class="sc">:.4f}</span><span class="ss">)'</span>, </span>
<span id="cb6-545"><a href="#cb6-545" aria-hidden="true" tabindex="-1"></a>                fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-546"><a href="#cb6-546" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb6-547"><a href="#cb6-547" aria-hidden="true" tabindex="-1"></a>    ax.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-548"><a href="#cb6-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-549"><a href="#cb6-549" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-550"><a href="#cb6-550" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-551"><a href="#cb6-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-552"><a href="#cb6-552" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Observations:"</span>)</span>
<span id="cb6-553"><a href="#cb6-553" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"• Degree 1 (linear) misses the curvature"</span>)</span>
<span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"• Degree 2 (quadratic) captures the main trend reasonably well"</span>)</span>
<span id="cb6-555"><a href="#cb6-555" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"• Degree 3 and higher may be overfitting (fitting noise)"</span>)</span>
<span id="cb6-556"><a href="#cb6-556" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"• The quadratic model (degree 2) is likely the best choice here"</span>)</span>
<span id="cb6-557"><a href="#cb6-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-558"><a href="#cb6-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-559"><a href="#cb6-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8. Quick Reference: Common Workflows</span></span>
<span id="cb6-560"><a href="#cb6-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-561"><a href="#cb6-561" aria-hidden="true" tabindex="-1"></a><span class="fu">### Workflow 1: Quick Polynomial Fit</span></span>
<span id="cb6-562"><a href="#cb6-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-563"><a href="#cb6-563" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb6-564"><a href="#cb6-564" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-565"><a href="#cb6-565" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-566"><a href="#cb6-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-567"><a href="#cb6-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Your data</span></span>
<span id="cb6-568"><a href="#cb6-568" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([...])</span>
<span id="cb6-569"><a href="#cb6-569" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([...])</span>
<span id="cb6-570"><a href="#cb6-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-571"><a href="#cb6-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a polynomial (degree 2 for quadratic)</span></span>
<span id="cb6-572"><a href="#cb6-572" aria-hidden="true" tabindex="-1"></a>coeffs <span class="op">=</span> np.polyfit(x, y, degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-573"><a href="#cb6-573" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> np.poly1d(coeffs)</span>
<span id="cb6-574"><a href="#cb6-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-575"><a href="#cb6-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb6-576"><a href="#cb6-576" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> poly(x)</span>
<span id="cb6-577"><a href="#cb6-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-578"><a href="#cb6-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb6-579"><a href="#cb6-579" aria-hidden="true" tabindex="-1"></a>x_smooth <span class="op">=</span> np.linspace(x.<span class="bu">min</span>(), x.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb6-580"><a href="#cb6-580" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb6-581"><a href="#cb6-581" aria-hidden="true" tabindex="-1"></a>plt.plot(x_smooth, poly(x_smooth), <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Fit'</span>)</span>
<span id="cb6-582"><a href="#cb6-582" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-583"><a href="#cb6-583" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-584"><a href="#cb6-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-585"><a href="#cb6-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-586"><a href="#cb6-586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Workflow 2: Evaluate Multiple Models</span></span>
<span id="cb6-587"><a href="#cb6-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-588"><a href="#cb6-588" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb6-589"><a href="#cb6-589" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> degree <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]:</span>
<span id="cb6-590"><a href="#cb6-590" aria-hidden="true" tabindex="-1"></a>    coeffs <span class="op">=</span> np.polyfit(x, y, degree)</span>
<span id="cb6-591"><a href="#cb6-591" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> np.poly1d(coeffs)(x)</span>
<span id="cb6-592"><a href="#cb6-592" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-593"><a href="#cb6-593" aria-hidden="true" tabindex="-1"></a>    ss_res <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_pred)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a>    ss_tot <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> np.mean(y))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-595"><a href="#cb6-595" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (ss_res <span class="op">/</span> ss_tot)</span>
<span id="cb6-596"><a href="#cb6-596" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-597"><a href="#cb6-597" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Degree </span><span class="sc">{</span>degree<span class="sc">}</span><span class="ss">: R² = </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb6-598"><a href="#cb6-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-599"><a href="#cb6-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-600"><a href="#cb6-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### Workflow 3: Manual Implementation (From Scratch)</span></span>
<span id="cb6-601"><a href="#cb6-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-602"><a href="#cb6-602" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb6-603"><a href="#cb6-603" aria-hidden="true" tabindex="-1"></a><span class="co"># For linear fit</span></span>
<span id="cb6-604"><a href="#cb6-604" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(<span class="bu">len</span>(x)), x])</span>
<span id="cb6-605"><a href="#cb6-605" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.linalg.solve(X.T <span class="op">@</span> X, X.T <span class="op">@</span> y)</span>
<span id="cb6-606"><a href="#cb6-606" aria-hidden="true" tabindex="-1"></a>b, m <span class="op">=</span> beta</span>
<span id="cb6-607"><a href="#cb6-607" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> m <span class="op">*</span> x <span class="op">+</span> b</span>
<span id="cb6-608"><a href="#cb6-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-609"><a href="#cb6-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-610"><a href="#cb6-610" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9. Practice Problems</span></span>
<span id="cb6-611"><a href="#cb6-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-612"><a href="#cb6-612" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem 1: Temperature vs. Ice Cream Sales</span></span>
<span id="cb6-613"><a href="#cb6-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-614"><a href="#cb6-614" aria-hidden="true" tabindex="-1"></a>Generate synthetic data where ice cream sales increase with temperature, then fit both linear and quadratic models. Which fits better? Why?</span>
<span id="cb6-615"><a href="#cb6-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-616"><a href="#cb6-616" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb6-617"><a href="#cb6-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb6-618"><a href="#cb6-618" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> np.linspace(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">20</span>) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb6-619"><a href="#cb6-619" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">15</span><span class="op">*</span>temp <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>temp<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">20</span>)</span>
<span id="cb6-620"><a href="#cb6-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-621"><a href="#cb6-621" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here:</span></span>
<span id="cb6-622"><a href="#cb6-622" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Fit degree 1 and degree 2 polynomials</span></span>
<span id="cb6-623"><a href="#cb6-623" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate R² for each</span></span>
<span id="cb6-624"><a href="#cb6-624" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot both fits</span></span>
<span id="cb6-625"><a href="#cb6-625" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Which is better?</span></span>
<span id="cb6-626"><a href="#cb6-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-627"><a href="#cb6-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-628"><a href="#cb6-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem 2: Implement Cubic Fitting from Scratch</span></span>
<span id="cb6-629"><a href="#cb6-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-630"><a href="#cb6-630" aria-hidden="true" tabindex="-1"></a>Using the matrix method (not <span class="in">`polyfit`</span>), fit a cubic polynomial ($y = b + m_1x + m_2x^2 + m_3x^3$) to the curved data.</span>
<span id="cb6-631"><a href="#cb6-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-632"><a href="#cb6-632" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb6-633"><a href="#cb6-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: Design matrix should have 4 columns: [1, x, x², x³]</span></span>
<span id="cb6-634"><a href="#cb6-634" aria-hidden="true" tabindex="-1"></a><span class="co"># Then solve: beta = np.linalg.solve(X.T @ X, X.T @ y)</span></span>
<span id="cb6-635"><a href="#cb6-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-636"><a href="#cb6-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-637"><a href="#cb6-637" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem 3: Predictions</span></span>
<span id="cb6-638"><a href="#cb6-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-639"><a href="#cb6-639" aria-hidden="true" tabindex="-1"></a>Using the house price model from earlier, predict the price for:</span>
<span id="cb6-640"><a href="#cb6-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A 1200 sqft house</span>
<span id="cb6-641"><a href="#cb6-641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A 2500 sqft house</span>
<span id="cb6-642"><a href="#cb6-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-643"><a href="#cb6-643" aria-hidden="true" tabindex="-1"></a>Do your predictions seem reasonable?</span>
<span id="cb6-644"><a href="#cb6-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-645"><a href="#cb6-645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem 4: Overfitting Investigation</span></span>
<span id="cb6-646"><a href="#cb6-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-647"><a href="#cb6-647" aria-hidden="true" tabindex="-1"></a>Fit polynomials of degree 1 through 10 to a dataset and plot how $R^2$ changes. At what degree does the $R^2$ stop improving meaningfully?</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Introduction to Coding and Data Analysis</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>